<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Nonparametric Hypothesis Testing – Understanding Uncertainty</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/chapter18.html" rel="next">
<link href="../notes/chapter16.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-9cf7f73ae95708c47935cfd4a35bc870.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/chapter10.html">Part 2: Statistics</a></li><li class="breadcrumb-item"><a href="../notes/chapter17.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonparametric Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Understanding Uncertainty</a> 
        <div class="sidebar-tools-main">
    <a href="../Understanding-Uncertainty.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Mathematical Foundations of Statistical Experiments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Core Concepts of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probabilities with More than One Event</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summarizing Statistical Experiments with Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Expected Value, Location Summaries, and Measures of Variability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Expectations and Variances with Multiple Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Named Discrete Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Continuous Random Variables</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">An Introduction to Descriptive Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Sampling Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Methods of Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Basics of Null Hypothesis Significance Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing and Confidence Intervals in Two Populations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter17.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonparametric Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">The Analysis of Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">The One-Way ANOVA</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#nonparametric-procedures-in-general" id="toc-nonparametric-procedures-in-general" class="nav-link active" data-scroll-target="#nonparametric-procedures-in-general"><span class="header-section-number">17.1</span> Nonparametric Procedures in General</a></li>
  <li><a href="#nonparametric-hypothesis-tests-for-location" id="toc-nonparametric-hypothesis-tests-for-location" class="nav-link" data-scroll-target="#nonparametric-hypothesis-tests-for-location"><span class="header-section-number">17.2</span> Nonparametric Hypothesis Tests for Location</a></li>
  <li><a href="#the-wilcoxon-signed-rank-test" id="toc-the-wilcoxon-signed-rank-test" class="nav-link" data-scroll-target="#the-wilcoxon-signed-rank-test"><span class="header-section-number">17.3</span> The Wilcoxon Signed-Rank Test</a>
  <ul class="collapse">
  <li><a href="#non-centered-data-ties-and-zeroes" id="toc-non-centered-data-ties-and-zeroes" class="nav-link" data-scroll-target="#non-centered-data-ties-and-zeroes"><span class="header-section-number">17.3.1</span> Non-Centered Data, Ties, and Zeroes</a></li>
  </ul></li>
  <li><a href="#the-mann-whitney-u-test" id="toc-the-mann-whitney-u-test" class="nav-link" data-scroll-target="#the-mann-whitney-u-test"><span class="header-section-number">17.4</span> The Mann-Whitney <span class="math inline">\(U\)</span>-Test</a>
  <ul class="collapse">
  <li><a href="#the-mann-whitney-u-test-for-location-shift-distributions" id="toc-the-mann-whitney-u-test-for-location-shift-distributions" class="nav-link" data-scroll-target="#the-mann-whitney-u-test-for-location-shift-distributions"><span class="header-section-number">17.4.1</span> The Mann-Whitney <span class="math inline">\(U\)</span>-Test for Location Shift Distributions</a></li>
  </ul></li>
  <li><a href="#the-wilcoxon-signed-rank-test-for-paired-data" id="toc-the-wilcoxon-signed-rank-test-for-paired-data" class="nav-link" data-scroll-target="#the-wilcoxon-signed-rank-test-for-paired-data"><span class="header-section-number">17.5</span> The Wilcoxon Signed-Rank Test (for Paired Data)</a></li>
  <li><a href="#the-true-value-of-nonparametric-tests" id="toc-the-true-value-of-nonparametric-tests" class="nav-link" data-scroll-target="#the-true-value-of-nonparametric-tests"><span class="header-section-number">17.6</span> The True Value of Nonparametric Tests</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">17.7</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/chapter10.html">Part 2: Statistics</a></li><li class="breadcrumb-item"><a href="../notes/chapter17.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonparametric Hypothesis Testing</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonparametric Hypothesis Testing</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Note: this chapter is currently being revised and completed. There may be a larger number of errors, omissions, etc. while it is being worked on. This note will be removed when the content is considered finalized.</p>
<section id="nonparametric-procedures-in-general" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="nonparametric-procedures-in-general"><span class="header-section-number">17.1</span> Nonparametric Procedures in General</h2>
<p>Ultimately, hypothesis testing procedures for the mean that rely on <span class="math inline">\(Z\)</span> or <span class="math inline">\(t\)</span> statistics have theory that is founded upon normality assumptions. The standardized test statistic, <span class="math display">\[T = \frac{\overline{X} - \mu_0}{S/\sqrt{n}},\]</span> has a <span class="math inline">\(t_{n-1}\)</span> distribution under the null whenever <span class="math inline">\(\overline{X}\)</span> is normally distributed. This is typically justified in one of two ways. First, many quantities that arise in practice are very close to being normally distributed. As a result, many physical quantities that we are interested in will have a population that is conducive to this testing in this manner. Alternatively, by appealing to the Central Limit Theorem, whenever the sample size is large enough, regardless of the population distribution, <span class="math inline">\(\overline{X}\)</span> should be approximately normally distributed. As a result, in large samples, these <span class="math inline">\(t\)</span> and <span class="math inline">\(Z\)</span> procedures can be justified. Depending on how strongly you desire rigorous justifications for mathematical procedures, these justifications may feel inadequate to support the widespread use of <span class="math inline">\(t\)</span>-tests. In both cases, the theory that has been developed is only <em>approximately</em> justified. This may lead one to question whether there are alternative procedures to perform the same types of hypothesis testing, but which do not rely on assuming that the estimator follows a normal distribution.</p>
<p>This question goes beyond the setting of hypothesis testing. Many statistical procedures rely either explicitly or implicitly on assumptions regarding the population distribution, at least for their theoretical justifications. These procedures are referred to as <strong>parametric methods</strong> since they rely on assumptions regarding the <em>parametric form</em> of the distribution.</p>
<div id="def-parametric-method" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.1 (Parametric Method)</strong></span> A <strong>parametric method</strong> or <strong>parametric technique</strong> is a statistical procedure that relies on assumptions regarding the specific structure of the distributions of the random variables of interest. Typically this will come in the form of assuming that the data follow some specific distribution, even if the values of the parameters are left unspecified.</p>
</div>
<p>Parametric methods are incredibly useful, and largely serve as the foundation for the most widely applied statistical methods. The concern with parametric methods, as discussed for the specific case of hypothesis testing, is that these methods are theoretically justified only when the parametric assumptions hold. If a population is assumed to follow a normal distribution, and it does not in fact follow the normal distribution, the theory can no longer provide guarantees as to the performance of the procedure. This does not necessarily mean that the procedure will not perform well, however, it does mean that justification for the application of the procedure is lacking. There are secondary approaches in statistics that remedy this, broadly referred to as <strong>nonparametric methods</strong>.</p>
<div id="def-nonparametric-method" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.2 (Nonparametric Method)</strong></span> A <strong>nonparametric method</strong> or <strong>nonparametric technique</strong> is a statistical procedure that does not rely upon strict assumptions regarding the structure of the distribution of the underlying random variables. Nonparametric techniques may make minimal assumptions regarding the shape of the distribution, such as assuming that the population distribution is symmetric. These assumptions are typically far less restrictive or easier to assess in practice.</p>
</div>
<p>Nonparametric techniques are designed to be flexible, and to apply well in a wide range of scenarios. This way, there can be confidence in the results obtained by applying the procedure, even when little is known or can be assumed about the underlying population distribution. This makes nonparametric methods attractive in a variety of settings. In the previous context, where we desire hypothesis tests for the mean that are not dependent on assumptions of normality, we can state this more plainly as desiring a nonparametric hypothesis testing procedure.</p>
</section>
<section id="nonparametric-hypothesis-tests-for-location" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="nonparametric-hypothesis-tests-for-location"><span class="header-section-number">17.2</span> Nonparametric Hypothesis Tests for Location</h2>
<p>It is frequently the case that scientific questions of interest center on the location of a population. Often this will be questions regarding the mean of a distribution, though, in certain contexts, the median or similar measures may be of particular interest. As a result, commonly used procedures for statistical inference are commonly motivated by questions relating to population locations. This is true for both parametric and nonparametric techniques.</p>
<p>When considering the application of nonparametric statistical inference, it is important to recognize some intricacies that arise when we are unwilling to make concrete assumptions regarding the population distribution. Notably, if we are willing to assume that the population is well-behaved,<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> then we are able to talk concretely about the parameters that specify these distributions. If instead we want to use a nonparametric technique, we forego the capacity to make these nice generalizations. By leaving the distributions we are considering unrestricted, it can be challenging to even specify the null or alternative hypothesis that we are interested in testing.</p>
<p>There are many distributions that are particularly poorly behaved. For instance, there are distributions that do not have means, or do not have variances. This is a strange concept, to have a distribution that is well-defined, and may very well describe data arising from some population, but which does not possess a mean or a variance. Still, if we want to consider truly nonparametric techniques, it is important that our methods recognize and account for this reality.</p>
<p>When approaching hypothesis testing nonparametrically, instead of discussing hypothesis tests for the mean of a distribution, we more commonly discuss hypothesis testing for the <em>location</em> of a distribution. The location of the distribution (<a href="chapter6.html#def-location" class="quarto-xref">Definition&nbsp;<span>6.1</span></a>) may correspond to the mean, when it exists, or the median, or similar related measurements. Despite this linguistic difference, nonparametric tests for the location of a distribution are analogous to parametric tests for the mean of a distribution.</p>
<p>Just as is the case with parametric hypothesis tests for the mean, there are multiple nonparametric hypothesis tests for the location of a population. These tests apply in different settings, depending on the available data, the specific parameter of interest, or the assumptions that the analyst is willing to make.</p>
</section>
<section id="the-wilcoxon-signed-rank-test" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="the-wilcoxon-signed-rank-test"><span class="header-section-number">17.3</span> The Wilcoxon Signed-Rank Test</h2>
<p>The simplest setup for a nonparametric test of location takes a single sample, denoted <span class="math inline">\(X_1, \dots, X_n\)</span>, from an unknown distribution. To begin, assume that there are no zeros in the data, and that no two observations have the same absolute value. While we do not assume any parametric form for the distribution, we will assume that the distribution is <strong>symmetric</strong>. In this setting, we are concerned with testing a null hypothesis of the form <span class="math inline">\(H_0: \mu = 0\)</span> versus the alternative <span class="math inline">\(H_A: \mu \neq 0\)</span>. Here, <span class="math inline">\(\mu\)</span> represents the location of the distribution. Because we assume that the distribution is symmetric, the mean<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> will coincide with the median, and as such, there is a candidate for a single measure of location. We may also wish to consider one-tail alternatives, either taking <span class="math inline">\(H_0: \mu \geq 0\)</span> versus <span class="math inline">\(H_A: \mu &lt; 0\)</span>, or <span class="math inline">\(H_0: \mu \leq 0\)</span> versus <span class="math inline">\(H_A: \mu &gt; 0\)</span>.</p>
<p>To test the hypothesis in this setting, we can make use of <strong>Wilcoxon’s Signed-Rank Test</strong>. In order to perform this test we need to consider the signed-rank of every observation, and then use these to compute a test statistic. Consider first the magnitude of each observed data point. That is, take <span class="math inline">\(|X_1|, |X_2|, |X_3|, \dots, |X_n|\)</span>. Each of these will produce a value that is (at least) zero. Further, by assumption, none of these values repeat. We can then consider ranking these magnitudes from smallest to largest, and assigning them their corresponding <strong>rank</strong>, <span class="math inline">\(R_1, R_2, \dots, R_n\)</span>.</p>
<p>For instance, suppose that we observe the sample <span class="math inline">\(\{-2, 1, -7, 9, 6\}\)</span>. Then, we first consider the magnitudes of each term in the sample, giving <span class="math inline">\(\{2, 1, 7, 9 6\}\)</span>. Next, we sort this set from smallest to largest, giving <span class="math inline">\(\{1, 2, 6, 7, 9\}\)</span>. Thus, the observation <span class="math inline">\(1\)</span> will receive a rank of <span class="math inline">\(1\)</span>, the observation <span class="math inline">\(-2\)</span> will receive a rank of <span class="math inline">\(2\)</span>, the observation <span class="math inline">\(6\)</span> will receive a rank of <span class="math inline">\(3\)</span>, the observation <span class="math inline">\(-7\)</span> will receive a rank of <span class="math inline">\(4\)</span>, and the observation <span class="math inline">\(9\)</span> will receive a rank of <span class="math inline">\(5\)</span>. We can summarize this, noting: <span class="math display">\[(x_1, x_2, x_3, x_4, x_5) = (-2, 1, -7, 9, 6) \quad\text{and}\quad (r_1, r_2, r_3, r_4, r_5) = (2, 1, 4, 5, 3).\]</span></p>
<p>With the ranks for each observation recorded, then we compute the <strong>signed-rank sum</strong>, denoted <span class="math inline">\(T\)</span>. Namely, taking <span class="math inline">\(\text{sgn}(x)\)</span> to represent the sign of <span class="math inline">\(x\)</span>, such that <span class="math inline">\(\text{sgn}(x) = -1\)</span> if <span class="math inline">\(x &lt; 0\)</span> and <span class="math inline">\(\text{sgn}(x) = 1\)</span> if <span class="math inline">\(x &gt; 0\)</span>, then <span class="math display">\[T = \sum_{i=1}^N \text{sgn}(X_i)R_i.\]</span> Under the null hypothesis, <span class="math inline">\(H_0: \mu = 0\)</span>, the signed-rank sum will be distributed according to the <strong>signed-rank distribution</strong>, parameterized by <span class="math inline">\(n\)</span>, the total sample size.</p>
<div id="def-signed-rank-sum" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.3 (Signed-Rank Sum)</strong></span> The <strong>signed-rank sum</strong>, denoted <span class="math inline">\(T\)</span>, is a test statistic used for nonparametric testing of a population location. Given data <span class="math inline">\((X_1, \dots, X_n)\)</span>, the data is first transformed into a set of ranks, <span class="math inline">\((R_1, \dots, R_n)\)</span>, determined by ranking the absolute values, <span class="math inline">\((|X_1|, \dots, |X_n|)\)</span>. Then, <span class="math display">\[T = \sum_{i=1}^n \text{sgn}(X_i)R_i.\]</span></p>
</div>
<p>The <span class="math inline">\(p\)</span>-value can then be determined on the basis of the signed-rank distribution. Namely, taking <span class="math inline">\(F_n\)</span> to be the cumulative distribution function for the signed-rank distribution based on a sample of size <span class="math inline">\(n\)</span>, then <span class="math display">\[p = P(T \leq -|t|) + P(T \geq |t|) = F_n(-|t|) + 1 - F_n(|t|).\]</span> Computing probabilities for the signed rank distribution is feasible, using a computer, for small values of <span class="math inline">\(n\)</span>. For larger values of <span class="math inline">\(n\)</span>, however, this is not the case. Instead, if <span class="math inline">\(n\)</span> is sufficiently large, then the signed-rank distribution is approximately normal, with a mean of <span class="math inline">\(0\)</span> and a variance of <span class="math inline">\(\dfrac{n(n+1)(2n+1)}{6}\)</span>. Thus, for large <span class="math inline">\(n\)</span>, the <span class="math inline">\(p\)</span>-value can be approximated as <span class="math display">\[p \approx 2\times\Phi\left(-\frac{|t|}{\sqrt{n(n+1)(2n+1)/6}}\right).\]</span></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wilcoxon Signed-Rank Tests for Single Populations (Without Ties)
</div>
</div>
<div class="callout-body-container callout-body">
<p>If data are selected from a symmetric population, and are such that the absolute values of all observed data points are unique, then the Wilcoxon Signed-Rank test can be used to test <span class="math inline">\(H_0: \mu = 0\)</span> versus <span class="math inline">\(H_0: \mu \neq 0\)</span>, or the one-tailed alternatives, where <span class="math inline">\(\mu\)</span> is the population location. To do so, the <strong>signed-rank sum</strong> test statistic is computed, <span class="math display">\[T = \sum_{i=1}^n \text{sgn}(X_i)R_i,\]</span> where <span class="math inline">\(R_i\)</span> is the rank order (smallest to largest) of <span class="math inline">\(|X_i|\)</span>.</p>
<p>Under the null hypothesis, <span class="math inline">\(T\)</span> follows a signed-rank distribution with size parameter <span class="math inline">\(n\)</span>. Taking <span class="math inline">\(T = t\)</span> based on the observed sample, the <span class="math inline">\(p\)</span>-value can be computed as:</p>
<ol type="1">
<li>If <span class="math inline">\(H_0: \mu = 0\)</span> versus <span class="math inline">\(H_A: \mu \neq 0\)</span>, then <span class="math display">\[p = F_n(-|t|) + 1 - F_n(|t|) \approx 2\Phi\left(-|t|/\sqrt{n(n+1)(2n+1)/6}\right).\]</span></li>
<li>If <span class="math inline">\(H_0: \mu \leq 0\)</span> versus <span class="math inline">\(H_A: \mu &gt; 0\)</span>, then <span class="math display">\[p = 1 - F_n(t) \approx 1 - \Phi\left(t/\sqrt{n(n+1)(2n+1)/6}\right).\]</span></li>
<li>If <span class="math inline">\(H_0: \mu \geq 0\)</span> versus <span class="math inline">\(H_A: \mu &lt; 0\)</span>, then <span class="math display">\[p = F_n(t) \approx \Phi\left(t/\sqrt{n(n+1)(2n+1)/6}\right).\]</span></li>
</ol>
</div>
</div>
<section id="non-centered-data-ties-and-zeroes" class="level3" data-number="17.3.1">
<h3 data-number="17.3.1" class="anchored" data-anchor-id="non-centered-data-ties-and-zeroes"><span class="header-section-number">17.3.1</span> Non-Centered Data, Ties, and Zeroes</h3>
<p>The Wilcoxon signed-rank test can only test the null hypothesis <span class="math inline">\(H_0: \mu = 0\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> This is useful whenever you expect that data are already centered, or if <span class="math inline">\(0\)</span> is truly the location of interest. Frequently, non-zero values for the location will be of interest. If there is a desire to test <span class="math inline">\(H_0: \mu = \mu_0\)</span>, for <span class="math inline">\(\mu_0 \neq 0\)</span>, then before the test can be run, the data need to first be centered. To do so, the observations <span class="math inline">\((X_1,\dots,X_n)\)</span> can be transformed into <span class="math inline">\((Z_1, \dots, Z_n) = (X_1 - \mu_0, \dots, X_n - \mu_0)\)</span>.</p>
<p>If the null hypothesis holds then <span class="math inline">\(X_i\)</span> is symmetric with location <span class="math inline">\(\mu_0\)</span>. Thus, by shifting the entire distribution, it must be the case that <span class="math inline">\(Z_i\)</span> is centered with location <span class="math inline">\(0\)</span>. As such, the Wilcoxon signed-rank test can then be applied to the computed <span class="math inline">\(Z_i\)</span> testing <span class="math inline">\(H_0: \mu_Z = 0\)</span> versus <span class="math inline">\(H_A: \mu_Z \neq 0\)</span>. This is equivalent to testing <span class="math inline">\(H_0: \mu = \mu_0\)</span> versus <span class="math inline">\(H_A: \mu \neq \mu_0\)</span>.</p>
<p>A secondary concern is the accommodation of tied ranks. Specifically, if there are two observations with the same magnitude then the procedure cannot proceed as described, as there is not a unique rank for each observed point. This presents challenges, particularly when analyzing discrete data, where ties may be prevalent. While several tie-breaking procedures exist, two common approaches are the <em>average rank procedure</em> and the <em>random rank procedure</em>. In the average rank procedure, the rank of any observation is the average of all possible ranks it could take on, if ties were broken in any possible way. Suppose that two points, <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_8\)</span>, have the same magnitude, and should be ranked as <span class="math inline">\(2\)</span> or <span class="math inline">\(3\)</span>. Then, in the average rank procedure, both would receive a rank of <span class="math inline">\(r = \dfrac{2+3}{2} = 2.5\)</span>. The random rank procedure, on the other hand, breaks ties completely at random. For any tied points, the order within the ties is randomly selected, and test proceeds as though those are the true ranks.</p>
<p>If the average rank procedure is used, the distribution under the null hypothesis changes slightly. It is still referred to as a signed-rank distribution, but it is a signed-rank distribution with average ranks. This is not a problem, computationally, but it does render the null distribution contingent on the observed data. There are further theoretical concerns with the average rank procedure that, in certain settings, can lead to paradoxical conclusions.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> The random rank procedure, on the other hand, produces a test statistic with the same null distribution regardless of whether ties exist or not. The primary drawback in this case is that the specific test statistic, and as such <span class="math inline">\(p\)</span>-value and conclusion, is dependent on both the observed data and the random rankings. To limit the impact that this has on final results, some researchers will run random ranking many times, and either collect the set of observed <span class="math inline">\(p\)</span>-values or else average the set of <span class="math inline">\(p\)</span>-values.</p>
<p>There is no single, universally preferred procedure for addressing ties. The most common approach in statistical software is<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> the average rank procedure. However, the drawbacks with paradoxical conclusions can be severe and limiting. Random ranking avoids these issues, but at the cost of a more arbitrary test statistic, depending on additional randomness. Some researchers have proposed variations on these techniques, or new tie-breaking procedures all together. While any approach is likely to produce satisfactory results in the event of a few ties within the data, should there be a very large number of ties it is likely preferable to consider alternative test procedures that directly accommodate the data.</p>
<p>A final concern in the application of the Wilcoxon signed-rank test is the presence of zeroes. There are two common approaches for addressing zeros: the <em>reduced sample procedure</em> and the <em>signed-rank zero procedure</em>. In the reduced sample procedure, zeroes are simply dropped from the sample. Then, the test procedure runs exactly as before. This is an easy approach, and does not require the null distribution to change, but has similar drawbacks to the average rank procedure described above. In particular, the reduce sample procedure may produce paradoxical conclusions. Alternatively, the signed-rank zero procedure still ranks the zeros, and defines <span class="math inline">\(\text{sgn}(0) = 0\)</span>. This way, all data are still ranked and included within the test statistic. This has several theoretical benefits over the reduced sample procedure, including resolving the paradoxical conclusions that can arise, but has the disadvantage of changing the null distribution in the presence of zeroes.</p>
<p>Between the two techniques, there is no statistically optimal approach. In certain cases the reduced sample procedure will outperform the signed-rank zero procedure, and vice versa. Just as with ties, most software implementations will have a technique for accounting for zeroes in the data. These techniques will likely perform suitably well for data with minimal zeroes, however, in the event of data with an abundance of zeroes, it is likely worthwhile to consider alternative test procedure all together.</p>
</section>
</section>
<section id="the-mann-whitney-u-test" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="the-mann-whitney-u-test"><span class="header-section-number">17.4</span> The Mann-Whitney <span class="math inline">\(U\)</span>-Test</h2>
<p>The signed-rank test allowed for nonparametric tests regarding a single population. A simple extension to this setting is the desire to run a hypothesis test comparing two independent populations. Suppose that <span class="math inline">\(X_{1},\dots,X_n\)</span> are drawn from the first population and <span class="math inline">\(Y_1,\dots,Y_m\)</span> are drawn from the second. General interest may be in whether the distribution of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are equivalent to one another, or not.</p>
<p>Considering the equivalence of the distributions tends to be a stronger requirement than in the parametric case of comparing equality of means. However, it is worth revisiting why this may be reasonable. Specifically, in the nonparametric case, it is not guaranteed that any two distributions can be characterized by the same parameters. One distribution may have a mean, while the other does not. In this setting, it would not be reasonable to compare population means, since there are not two means to compare. If, when running the test comparing the populations, you are willing to make stronger assumptions regarding the distribution, it is possible to convert a test of equality of distributions into a direct test of location measures. For instance, suppose you are willing to assume that the population distributions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are equivalent except for, perhaps, their location. In this case testing whether the distributions are equivalent is the same as testing whether the locations are equal. In the standard <span class="math inline">\(t\)</span>-test, this is essentially the assumption that is made. For nonparametric testing, it is useful to leave this more broad.</p>
<p>Denoting the cumulative distribution function of the first population, <span class="math inline">\(F_X\)</span>, and of the second population, <span class="math inline">\(F_Y\)</span>, the process of testing for equality of distributions can be expressed as testing the null hypothesis <span class="math inline">\(H_0: F_X = F_Y\)</span> versus the alternative <span class="math inline">\(H_A: F_X \neq F_Y\)</span>. To do this nonparametrically, we can apply the Mann-Whitney <span class="math inline">\(U\)</span>-test. The Mann-Whitney <span class="math inline">\(U\)</span>-test is also referred to as the rank-sum test, the Mann-Whitney-Wilcoxon test, or the Wilcoxon rank-sum test. To ensure that the test remains clearly distinguished from the signed-rank test, it will be referred to as the <span class="math inline">\(U\)</span>-test. The <span class="math inline">\(U\)</span>-test, like the signed-rank test, relies on the ranks of the data. Unlike the signed-rank test, however, these are not the ranks of the absolute values, but rather the ranks of the data directly. Specifically, consider the combined sample of <span class="math inline">\(\{X_1,X_2,\dots,X_n,Y_1,Y_2,\dots,Y_m\}\)</span>. Within this sample, rank all the observations from smallest to largest, assigning the ranks as <span class="math inline">\(\{R_1,R_2,\dots,R_{n+m}\}\)</span>.</p>
<p>With the ranks for each data point computed, we can then compute the <strong>rank-sum</strong> for each sample. Namely, take <span class="math inline">\(R_X\)</span> to be the sum of all the ranks from the observations corresponding to <span class="math inline">\(\{X_1,\dots,X_n\}\)</span> and <span class="math inline">\(R_Y\)</span> to be the sum of all the ranks from the observations corresponding to <span class="math inline">\(\{Y_1,\dots,Y_m\}\)</span>. That is, <span class="math display">\[R_X = \sum_{i=1}^n R_i \quad\text{and}\quad R_Y = \sum_{i=1}^m R_{n+i}.\]</span> Once the rank-sum is calculated for both samples, the <span class="math inline">\(U\)</span>-statistics can be as well. Specifically take <span class="math display">\[U_X = nm + \frac{n(n+1)}{2} - R_X \quad\text{and}\quad U_Y = nm + \frac{m(m+1)}{2} - R_Y.\]</span></p>
<p>The <strong>Mann-Whitney <span class="math inline">\(U\)</span>-Statistic</strong> is then given by <span class="math inline">\(U = \min\{U_X, U_Y\}\)</span>. Under the null hypothesis, the <span class="math inline">\(U\)</span>-statistic will follow the Wilcoxon rank-sum distribution. This distribution is characterized by both sample sizes, <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>. Thus, taking <span class="math inline">\(F_{n,m}\)</span> to be the cumulative distribution function for the Wilcoxon rank-sum distribution, then the <span class="math inline">\(p\)</span>-value for the <span class="math inline">\(U\)</span>-test will be <span class="math display">\[p = 2\times\min\{F_{n,m}(u), 1 - F_{n,m}(u)\}.\]</span> The form of this <span class="math inline">\(p\)</span>-value arises since the distribution will not be symmetric around <span class="math inline">\(0\)</span>.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> When both <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> are large, then the null distribution is well-approximated by a normal distribution. Specifically, for large <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, <span class="math display">\[U \stackrel{\dot H_0}{\sim} N\left(\frac{nm}{2}, \frac{nm(n+m+1)}{12}\right).\]</span> Thus, for the <span class="math inline">\(p\)</span>-value, <span class="math display">\[p \approx 2\times\Phi\left(-\frac{|U - nm/2|}{\sqrt{nm(n+m+1)/12}}\right).\]</span></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Mann-Whitney <span class="math inline">\(U\)</span>-Test (General)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose that two independent samples are drawn from two separate populations, denoted <span class="math inline">\(X_1,\dots,X_n\)</span> from the first and <span class="math inline">\(Y_1,\dots,Y_m\)</span> from the second. The distribution function for <span class="math inline">\(X_i\)</span> is <span class="math inline">\(F_X\)</span> and the distribution function for <span class="math inline">\(Y_i\)</span> is <span class="math inline">\(F_Y\)</span>. To test the null hypothesis that the distributions are equivalent, <span class="math inline">\(H_0: F_X = F_Y\)</span>, versus the alternative that they differ, <span class="math inline">\(H_A: F_X \neq F_Y\)</span>, the Mann-Whtiney <span class="math inline">\(U\)</span>-test can be run. First, all data from the two samples are combined and ranked. Then, the rank-sum statistics are computed for both samples, giving <span class="math inline">\(R_X\)</span> and <span class="math inline">\(R_Y\)</span>. Using these statistics, the <span class="math inline">\(U\)</span>-statistics for each sample are computed as <span class="math display">\[U_X = nm + \frac{n(n+1)}{2} - R_X \quad\text{and}\quad U_Y = nm + \frac{m(m+1)}{2} - R_Y.\]</span> Finally, <span class="math inline">\(U = \min\{U_X, U_Y\}\)</span> is calculated as the <span class="math inline">\(U\)</span> statistic.</p>
<p>Under the null hypothesis, <span class="math inline">\(U\)</span> follows a rank-sum distribution with size parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>. Taking <span class="math inline">\(U = u\)</span> based on the observed sample, the <span class="math inline">\(p\)</span>-value can be computed as: <span class="math display">\[p = 2\times\min\{F_{n,m}(u), 1 - F_{n,m}(u)\} \approx 2\times\Phi\left(-\frac{|U - nm/2|}{\sqrt{nm(n+m+1)/12}}\right).\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formality Under the Alternative
</div>
</div>
<div class="callout-body-container callout-body">
<p>In order for the <span class="math inline">\(U\)</span>-test to give consistent,<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> accurate results, then a further assumption is required under the alternative hypothesis. Namely, it must be the case that <span class="math inline">\(P(X &gt; Y) \neq P(Y &gt; X)\)</span> if the <span class="fg highlight">alternative hypothesis</span> holds. Thus, if <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> both have symmetric distributions, centered on the same value, then the <span class="math inline">\(U\)</span>-test will not reliably conclude that the distributions are different, even when sample sizes grow indefinitely. This is a fairly technical consideration, but it is important when applying the <span class="math inline">\(U\)</span>-test in practice. If you suspect that the two distributions are symmetric, and centered on the same value, the hypothesis test is no longer correctly regarded as testing <span class="math inline">\(F_X = F_Y\)</span>. To do so, alternative test procedures would be required.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
</div>
</div>
<section id="the-mann-whitney-u-test-for-location-shift-distributions" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="the-mann-whitney-u-test-for-location-shift-distributions"><span class="header-section-number">17.4.1</span> The Mann-Whitney <span class="math inline">\(U\)</span>-Test for Location Shift Distributions</h3>
<p>Because the null hypothesis is that the two distributions are equivalent, it is possible to reject the null hypothesis when the location of the two samples is equivalent. This is because two distributions that share a location are not necessarily equivalent. Consider, for instance, the <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(t_3\)</span> distributions. Both have a location of <span class="math inline">\(0\)</span>, but otherwise behave quite differently. This is a desirable property of the <span class="math inline">\(U\)</span>-test, that makes it broadly applicable. However, on occasion it may be desirable to test whether <span class="math inline">\(\mu_X = \mu_Y\)</span>, or more broadly, <span class="math inline">\(H_0: \mu_X - \mu_Y = \Delta_0\)</span>, for some fixed constant. The <span class="math inline">\(U\)</span>-test can be extended to this setting, under <strong>stricter assumptions</strong> regarding the null and alternative distributions.</p>
<p>Namely, if it is assumed that <span class="math inline">\(F_X(x) = F_Y(y + \delta)\)</span>, for some value <span class="math inline">\(\delta\)</span>, then we are in effect saying that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have equivalent distributions, except they are shifted away from one another by <span class="math inline">\(\delta\)</span>. In this context, testing whether <span class="math inline">\(F_X\)</span> and <span class="math inline">\(F_Y\)</span> are equivalent is the same as testing whether <span class="math inline">\(\delta = 0\)</span>, or alternatively, whether <span class="math inline">\(\mu_X = \mu_Y\)</span>. Thus, if we are willing to assume that it is impossible for the distributions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> to differ, except in location, then the <span class="math inline">\(U\)</span>-test becomes a test about the equality of those locations. Note that it is not possible to test the assumption that the distributions are otherwise equivalent, and as a result, using the <span class="math inline">\(U\)</span>-test in this way is only valid when this assumption is justified via subject-matter arguments.</p>
<p>When this assumption is made, in order to test <span class="math inline">\(H_0: \mu_X - \mu_Y = \Delta_0\)</span>, the <span class="math inline">\(U\)</span>-test can be directly applied to <span class="math inline">\(X_1,\dots,X_n\)</span> for the first sample, and <span class="math inline">\(Y_1 + \Delta_0, \dots, Y_n + \Delta_0\)</span> for the second. Note that if the null hypothesis holds, then <span class="math inline">\(\mu_X = \mu_Y + \Delta_0\)</span>, and so <span class="math inline">\(Y + \Delta_0\)</span> will have location <span class="math inline">\(\mu_X\)</span>. Then testing <span class="math inline">\(F_X = F_{Y+\Delta_0}\)</span> is equivalent to testing whether their locations are equal.</p>
</section>
</section>
<section id="the-wilcoxon-signed-rank-test-for-paired-data" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="the-wilcoxon-signed-rank-test-for-paired-data"><span class="header-section-number">17.5</span> The Wilcoxon Signed-Rank Test (for Paired Data)</h2>
</section>
<section id="the-true-value-of-nonparametric-tests" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="the-true-value-of-nonparametric-tests"><span class="header-section-number">17.6</span> The True Value of Nonparametric Tests</h2>
</section>
<section id="exercises" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="exercises"><span class="header-section-number">17.7</span> Exercises</h2>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>For instance, that it follows a normal distribution, a binomial distribution, or similar.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>If it exists.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Or, the one-tailed equivalents.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Specifically, it is possible that the average rank procedure rejects the null hypothesis in the one tail test, concluding (for instance) that <span class="math inline">\(\mu &gt; 0\)</span>. However, using the same data, if you add some amount to the tied data points, making them more positive, then the null hypothesis may not be rejected any longer. These two conclusions are incompatible with one another, and arise as a natural consequence of the average rank procedure.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Very likely.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>In the case of <span class="math inline">\(Z\)</span>-tests, <span class="math inline">\(t\)</span>-tests, and the presented version of the signed-rank test, the null distribution has always been symmetric around <span class="math inline">\(0\)</span>. In this case we must have that <span class="math inline">\(F(-|t|) = 1-F(|t|)\)</span> and as such, we can express the <span class="math inline">\(p\)</span>-value as the sum of the two tails. For non-symmetric null distributions, we still wish to understand the probability of observing something at least as extreme as what was actually observed. Here, however, that is not as simple as saying less than <span class="math inline">\(-|t|\)</span> or above <span class="math inline">\(|t|\)</span>, since the distribution is not centered on <span class="math inline">\(0\)</span>. In fact, in the case of the <span class="math inline">\(U\)</span>-statistic, the null distribution is strictly positive. This form, <span class="math inline">\(2\times\min\{F(u), 1-F(u)\}\)</span> is broadly applicable across many hypothesis tests, however, it tends to be less informative compared to the sum of the tail probabilities.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Note that here, consistency refers to a specific statistical idea. Namely, consistency represents the idea that, as sample sizes increase larger and larger, the resulting statistical procedure will approach the correct results.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>For instance, the Kolmogorov-Smirnov test is a nonparametric test that considers the equality (or lack thereof) of continuous distributions, without making the same assumptions under the null hypothesis.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/chapter16.html" class="pagination-link" aria-label="Hypothesis Testing and Confidence Intervals in Two Populations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing and Confidence Intervals in Two Populations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/chapter18.html" class="pagination-link" aria-label="The Analysis of Categorical Data">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">The Analysis of Categorical Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script type="application/javascript" src="../webex.js"></script>




</body></html>