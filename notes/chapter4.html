<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Probabilities with More than One Event – Understanding Uncertainty</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/chapter5.html" rel="next">
<link href="../notes/chapter3.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs/editor/editor.main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer">
  
<style type="text/css">.monaco-editor pre {
  background-color: unset !important;
}

.qwebr-icon-status-spinner {
  color: #7894c4;
}

.qwebr-icon-run-code {
  color: #0d9c29
}

.qwebr-output-code-stdout {
  color: #111;
}

.qwebr-output-code-stderr {
  color: #db4133;
}

.qwebr-editor {
  border: 1px solid #EEEEEE;
}

.qwebr-button-run {
  background-color: #EEEEEE;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0; /* Extra styling for consistency */
  display: inline-block;
  font-weight: 400;
  line-height: 1.5;
  color: #000;
  text-align: center;
  text-decoration: none;
  -webkit-text-decoration: none;
  -moz-text-decoration: none;
  -ms-text-decoration: none;
  -o-text-decoration: none;
  /* vertical-align: middle; */ /* Prevents a space from appearing between the code cell and button */
  -webkit-user-select: none;
  border-color: #dee2e6;
  border: 1px solid rgba(0,0,0,0);
  padding: 0.375rem 0.75rem;
  font-size: 1rem;
  border-top-right-radius: 0.25rem;
  border-top-left-radius: 0.25rem;
  transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}

.qwebr-button-run:hover {
  color: #000;
  background-color: #e3e6ea;
  border-color: #e1e5e9;
}

.qwebr-button-run:disabled,.qwebr-button-run.disabled,fieldset:disabled .qwebr-button-run {
  pointer-events: none;
  opacity: .65
}

/* Custom styling for RevealJS Presentations*/

/* Reset the style of the interactive area */
.reveal div.qwebr-interactive-area {
  display: block;
  box-shadow: none;
  max-width: 100%;
  max-height: 100%;
  margin: 0;
  padding: 0;
} 

/* Provide space to entries */
.reveal div.qwebr-output-code-area pre div {
  margin: 1px 2px 1px 10px;
}

/* Collapse the inside code tags to avoid extra space between line outputs */
.reveal pre div code.qwebr-output-code-stdout, .reveal pre div code.qwebr-output-code-stderr {
  padding: 0;
  display: contents;
}

.reveal pre div code.qwebr-output-code-stdout {
  color: #111;
}

.reveal pre div code.qwebr-output-code-stderr {
  color: #db4133;
}


/* Create a border around console and output (does not effect graphs) */
.reveal div.qwebr-console-area {
  border: 1px solid #EEEEEE;
  box-shadow: 2px 2px 10px #EEEEEE;
}

/* Cap output height and allow text to scroll */
/* TODO: Is there a better way to fit contents/max it parallel to the monaco editor size? */
.reveal div.qwebr-output-code-area pre {
  max-height: 400px;
  overflow: scroll;
}
</style>
<script type="module">// Start a timer
const initializeWebRTimerStart = performance.now();

// Determine if we need to install R packages
var installRPackagesList = [''];
// Check to see if we have an empty array, if we do set to skip the installation.
var setupRPackages = !(installRPackagesList.indexOf("") !== -1);
var autoloadRPackages = true;

// Display a startup message?
var showStartupMessage = true;
var showHeaderMessage = false;
if (showStartupMessage) {

  // Get references to header elements
  const headerHTML = document.getElementById("title-block-header");
  const headerRevealJS = document.getElementById("title-slide");

  // Create the outermost div element for metadata
  const quartoTitleMeta = document.createElement("div");
  quartoTitleMeta.classList.add("quarto-title-meta");

  // Create the first inner div element
  const firstInnerDiv = document.createElement("div");
  firstInnerDiv.setAttribute("id", "qwebr-status-message-area");

  // Create the second inner div element for "WebR Status" heading and contents
  const secondInnerDiv = document.createElement("div");
  secondInnerDiv.setAttribute("id", "qwebr-status-message-title");
  secondInnerDiv.classList.add("quarto-title-meta-heading");
  secondInnerDiv.innerText = "WebR Status";

  // Create another inner div for contents
  const secondInnerDivContents = document.createElement("div");
  secondInnerDivContents.setAttribute("id", "qwebr-status-message-body");
  secondInnerDivContents.classList.add("quarto-title-meta-contents");

  // Describe the WebR state
  var startupMessageWebR = document.createElement("p");
  startupMessageWebR.innerText = "🟡 Loading...";
  startupMessageWebR.setAttribute("id", "qwebr-status-message-text");
  // Add `aria-live` to auto-announce the startup status to screen readers
  startupMessageWebR.setAttribute("aria-live", "assertive");

  // Append the startup message to the contents
  secondInnerDivContents.appendChild(startupMessageWebR);

  // Add a status indicator for COOP and COEP Headers if needed
  if (showHeaderMessage) {
    const crossOriginMessage = document.createElement("p");
    crossOriginMessage.innerText = `${crossOriginIsolated ? '🟢' : '🟡'} COOP & COEP Headers`;
    crossOriginMessage.setAttribute("id", "qwebr-coop-coep-header");
    secondInnerDivContents.appendChild(crossOriginMessage);
  }

  // Combine the inner divs and contents
  firstInnerDiv.appendChild(secondInnerDiv);
  firstInnerDiv.appendChild(secondInnerDivContents);
  quartoTitleMeta.appendChild(firstInnerDiv);

  // Determine where to insert the quartoTitleMeta element
  if (headerHTML) {
    // Append to the existing "title-block-header" element
    headerHTML.appendChild(quartoTitleMeta);
  } else if (headerRevealJS) {
    // If using RevealJS, add to the "title-slide" div
    headerRevealJS.appendChild(firstInnerDiv);
  } else {
    // If neither headerHTML nor headerRevealJS is found, insert after "webr-monaco-editor-init" script
    const monacoScript = document.getElementById("qwebr-monaco-editor-init");
    const header = document.createElement("header");
    header.setAttribute("id", "title-block-header");
    header.appendChild(quartoTitleMeta);
    monacoScript.after(header);
  }
}

// Retrieve the webr.mjs
import { WebR, ChannelType } from "https://webr.r-wasm.org/v0.2.2/webr.mjs";

// Populate WebR options with defaults or new values based on 
// webr meta
globalThis.webR = new WebR({
  "baseURL": "https://webr.r-wasm.org/v0.2.2/",
  "serviceWorkerUrl": "",
  "homedir": "/home/web_user", 
  "channelType": ChannelType.Automatic
});

// Initialization WebR
await webR.init();

// Setup a shelter
globalThis.webRCodeShelter = await new webR.Shelter();

// Setup a pager to allow processing help documentation 
await webR.evalRVoid('webr::pager_install()'); 

// Function to set the button text
function qwebrSetInteractiveButtonState(buttonText, enableCodeButton = true) {
  document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
    btn.innerHTML = buttonText;
    btn.disabled = !enableCodeButton;
  });
}

// Function to update the status message
function qwebrUpdateStatusHeader(message) {
  startupMessageWebR.innerHTML = `
    <i class="fa-solid fa-spinner fa-spin qwebr-icon-status-spinner"></i>
    <span>${message}</span>`;
}

// Function to install a single package
async function qwebrInstallRPackage(packageName) {
  await globalThis.webR.installPackages([packageName]);
}

// Function to load a single package
async function qwebrLoadRPackage(packageName) {
  await globalThis.webR.evalRVoid(`library(${packageName});`);
}

// Generic function to process R packages
async function qwebrProcessRPackagesWithStatus(packages, processType, displayStatusMessageUpdate = true) {
  // Switch between contexts
  const messagePrefix = processType === 'install' ? 'Installing' : 'Loading';

  // Modify button state
  qwebrSetInteractiveButtonState(`🟡 ${messagePrefix} package ...`, false);

  // Iterate over packages
  for (let i = 0; i < packages.length; i++) {
    const activePackage = packages[i];
    const formattedMessage = `${messagePrefix} package ${i + 1} out of ${packages.length}: ${activePackage}`;
    
    // Display the update
    if (displayStatusMessageUpdate) {
      qwebrUpdateStatusHeader(formattedMessage);
    }

    // Run package installation
    if (processType === 'install') {
      await qwebrInstallRPackage(activePackage);
    } else {
      await qwebrLoadRPackage(activePackage);
    }
  }

  // Clean slate
  if (processType === 'load') {
    await globalThis.webR.flush();
  }
}


// Check to see if any packages need to be installed
if (setupRPackages) {
  // Obtain only a unique list of packages
  const uniqueRPackageList = Array.from(new Set(installRPackagesList));

  // Install R packages one at a time (either silently or with a status update)
  await qwebrProcessRPackagesWithStatus(uniqueRPackageList, 'install', showStartupMessage);

  if(autoloadRPackages) {
    // Load R packages one at a time (either silently or with a status update)
    await qwebrProcessRPackagesWithStatus(uniqueRPackageList, 'load', showStartupMessage);
  }
}

// Stop timer
const initializeWebRTimerEnd = performance.now();

// Release document status as ready
if (showStartupMessage) {
  startupMessageWebR.innerText = "🟢 Ready!"
}

qwebrSetInteractiveButtonState(
  `<i class="fa-solid fa-play qwebr-icon-run-code"></i> <span>Run Code</span>`, 
  true
);

// Global version of the Escape HTML function that converts HTML 
// characters to their HTML entities.
globalThis.qwebrEscapeHTMLCharacters = function(unsafe) {
  return unsafe
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
};</script>
<script type="module">// Supported Evaluation Types for Context
globalThis.EvalTypes = Object.freeze({
    Interactive: 'interactive',
    Setup: 'setup',
    Output: 'output',
});

// Function to verify a given JavaScript Object is empty
globalThis.qwebrIsObjectEmpty = function (arr) {
    return Object.keys(arr).length === 0;
}

// Function to parse the pager results
globalThis.qwebrParseTypePager = async function (msg) { 

    // Split out the event data
    const { path, title, deleteFile } = msg.data; 

    // Process the pager data by reading the information from disk
    const paged_data = await webR.FS.readFile(path).then((data) => {
        // Obtain the file content
        let content = new TextDecoder().decode(data);

        // Remove excessive backspace characters until none remain
        while(content.match(/.[\b]/)){
        content = content.replace(/.[\b]/g, '');
        }

        // Returned cleaned data
        return content;
    });

    // Unlink file if needed
    if (deleteFile) { 
        await webR.FS.unlink(path); 
    } 

    // Return extracted data with spaces
    return paged_data;
} 

// Function to run the code using webR and parse the output
globalThis.qwebrComputeEngine = async function(
    codeToRun, 
    elements, 
    options) {

    // Call into the R compute engine that persists within the document scope.
    // To be prepared for all scenarios, the following happens: 
    // 1. We setup a canvas device to write to by making a namespace call into the {webr} package
    // 2. We use values inside of the options array to set the figure size.
    // 3. We capture the output stream information (STDOUT and STERR)
    // 4. While parsing the results, we disable image creation.

    // Create a canvas variable for graphics
    let canvas = undefined;

    // Create a pager variable for help/file contents
    let pager = [];

    // ---- 

    // Initialize webR
    await webR.init();

    // Setup a webR canvas by making a namespace call into the {webr} package
    await webR.evalRVoid(`webr::canvas(width=${options["fig-width"]}, height=${options["fig-height"]})`);

    const result = await webRCodeShelter.captureR(codeToRun, {
        withAutoprint: true,
        captureStreams: true,
        captureConditions: false//,
        // env: webR.objs.emptyEnv, // maintain a global environment for webR v0.2.0
    });

    // -----

    // Start attempting to parse the result data
    try {

        // Stop creating images
        await webR.evalRVoid("dev.off()");

        // Merge output streams of STDOUT and STDErr (messages and errors are combined.)
        const out = result.output
        .filter(evt => evt.type === "stdout" || evt.type === "stderr")
        .map((evt, index) => {
            const className = `qwebr-output-code-${evt.type}`;
            return `<code id="${className}-editor-${elements.id}-result-${index + 1}" class="${className}">${qwebrEscapeHTMLCharacters(evt.data)}</code>`;
        })
        .join("\n");


        // Clean the state
        // We're now able to process both graphics and pager events.
        // As a result, we cannot maintain a true 1-to-1 output order 
        // without individually feeding each line
        const msgs = await webR.flush();

        // Output each image event stored
        msgs.forEach((msg) => {
        // Determine if old canvas can be used or a new canvas is required.
        if (msg.type === 'canvas'){
            // Add image to the current canvas
            if (msg.data.event === 'canvasImage') {
                canvas.getContext('2d').drawImage(msg.data.image, 0, 0);
            } else if (msg.data.event === 'canvasNewPage') {
                // Generate a new canvas element
                canvas = document.createElement("canvas");
                canvas.setAttribute("width", 2 * options["fig-width"]);
                canvas.setAttribute("height", 2 * options["fig-height"]);
                canvas.style.width = "700px";
                canvas.style.display = "block";
                canvas.style.margin = "auto";
            }
        } 
        });

        // Use `map` to process the filtered "pager" events asynchronously
        const pager = await Promise.all(
            msgs.filter(msg => msg.type === 'pager').map(
                async (msg) => {
                    return await qwebrParseTypePager(msg);
                }
            )
        );

        // Nullify the output area of content
        elements.outputCodeDiv.innerHTML = "";
        elements.outputGraphDiv.innerHTML = "";

        // Design an output object for messages
        const pre = document.createElement("pre");
        if (/\S/.test(out)) {
            // Display results as HTML elements to retain output styling
            const div = document.createElement("div");
            div.innerHTML = out;
            pre.appendChild(div);
        } else {
            // If nothing is present, hide the element.
            pre.style.visibility = "hidden";
        }

        elements.outputCodeDiv.appendChild(pre);

        // Place the graphics on the canvas
        if (canvas) {
            elements.outputGraphDiv.appendChild(canvas);
        }

        // Display the pager data
        if (pager) {
        // Use the `pre` element to preserve whitespace.
        pager.forEach((paged_data, index) => {
            let pre_pager = document.createElement("pre");
            pre_pager.innerText = paged_data;
            pre_pager.classList.add("qwebr-output-code-pager");
            pre_pager.setAttribute("id", `qwebr-output-code-pager-editor-${elements.id}-result-${index + 1}`);
            elements.outputCodeDiv.appendChild(pre_pager);
        });
        }
    } finally {
        // Clean up the remaining code
        webRCodeShelter.purge();
    }
}

// Function to execute the code (accepts code as an argument)
globalThis.qwebrExecuteCode = async function (
    codeToRun,
    id,
    evalType = EvalTypes.Interactive,
    options = {}) {

    // If options are not passed, we fall back on the bare minimum to handle the computation
    if (qwebrIsObjectEmpty(options)) {
        options = { "fig-width": 504, "fig-height": 360 };
    }

    // Next, we access the compute areas values
    const elements = {
        runButton: document.getElementById(`qwebr-button-run-${id}`),
        outputCodeDiv: document.getElementById(`qwebr-output-code-area-${id}`),
        outputGraphDiv: document.getElementById(`qwebr-output-graph-area-${id}`),
        id: id,
    }

    // Disallowing execution of other code cells
    document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
        btn.disabled = true;
    });

    if (evalType == EvalTypes.Interactive) {
        // Emphasize the active code cell
        elements.runButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin qwebr-icon-status-spinner"></i> <span>Run Code</span>';
    }

    // Evaluate the code and parse the output into the document
    await qwebrComputeEngine(codeToRun, elements, options);

    // Switch to allowing execution of code
    document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
        btn.disabled = false;
    });

    if (evalType == EvalTypes.Interactive) {
        // Revert to the initial code cell state
        elements.runButton.innerHTML = '<i class="fa-solid fa-play qwebr-icon-run-code"></i> <span>Run Code</span>';
    }
}
</script>
<script type="module">// Function that dispatches the creation request
globalThis.qwebrCreateHTMLElement = function (insertElement,
  qwebrCounter, 
  evalType = EvalTypes.Interactive,
  options = {}) {

  // Figure out the routine to use to insert the element.
  let qwebrElement;
  switch ( evalType ) {
    case EvalTypes.Interactive: 
      qwebrElement = qwebrCreateInteractiveElement(qwebrCounter);
    case EvalTypes.Output: 
      qwebrElement = qwebrCreateNonInteractiveOutputElement(qwebrCounter);
    case EvalTypes.Setup: 
      qwebrElement = qwebrCreateNonInteractiveSetupElement(qwebrCounter);
    default: 
      qwebrElement = document.createElement('div');
      qwebrElement.textContent = 'Error creating element';
  }

  // Insert the dynamically generated object at the document location.
  insertElement.appendChild(qwebrElement);
};

// Function that setups the interactive element creation
globalThis.qwebrCreateInteractiveElement = function (qwebrCounter) {

  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = 'qwebr-interactive-area-' + qwebrCounter;
  mainDiv.className = 'qwebr-interactive-area';

  // Create button element
  var button = document.createElement('button');
  button.className = 'btn btn-default qwebr-button-run';
  button.disabled = true;
  button.type = 'button';
  button.id = 'qwebr-button-run-' + qwebrCounter;
  button.textContent = '🟡 Loading webR...';

  // Create console area div
  var consoleAreaDiv = document.createElement('div');
  consoleAreaDiv.id = 'qwebr-console-area-' + qwebrCounter;
  consoleAreaDiv.className = 'qwebr-console-area';

  // Create editor div
  var editorDiv = document.createElement('div');
  editorDiv.id = 'qwebr-editor-' + qwebrCounter;
  editorDiv.className = 'qwebr-editor';

  // Create output code area div
  var outputCodeAreaDiv = document.createElement('div');
  outputCodeAreaDiv.id = 'qwebr-output-code-area-' + qwebrCounter;
  outputCodeAreaDiv.className = 'qwebr-output-code-area';
  outputCodeAreaDiv.setAttribute('aria-live', 'assertive');

  // Create pre element inside output code area
  var preElement = document.createElement('pre');
  preElement.style.visibility = 'hidden';
  outputCodeAreaDiv.appendChild(preElement);

  // Create output graph area div
  var outputGraphAreaDiv = document.createElement('div');
  outputGraphAreaDiv.id = 'qwebr-output-graph-area-' + qwebrCounter;
  outputGraphAreaDiv.className = 'qwebr-output-graph-area';

  // Append all elements to the main div
  mainDiv.appendChild(button);
  consoleAreaDiv.appendChild(editorDiv);
  consoleAreaDiv.appendChild(outputCodeAreaDiv);
  mainDiv.appendChild(consoleAreaDiv);
  mainDiv.appendChild(outputGraphAreaDiv);

  return mainDiv;
}

// Function that adds output structure for non-interactive output
globalThis.qwebrCreateNonInteractiveOutputElement = function(qwebrCounter) {
  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = 'qwebr-noninteractive-area-' + qwebrCounter;
  mainDiv.className = 'qwebr-noninteractive-area';

  // Create output code area div
  var outputCodeAreaDiv = document.createElement('div');
  outputCodeAreaDiv.id = 'qwebr-output-code-area-' + qwebrCounter;
  outputCodeAreaDiv.className = 'qwebr-output-code-area';
  outputCodeAreaDiv.setAttribute('aria-live', 'assertive');

  // Create pre element inside output code area
  var preElement = document.createElement('pre');
  preElement.style.visibility = 'hidden';
  outputCodeAreaDiv.appendChild(preElement);

  // Create output graph area div
  var outputGraphAreaDiv = document.createElement('div');
  outputGraphAreaDiv.id = 'qwebr-output-graph-area-' + qwebrCounter;
  outputGraphAreaDiv.className = 'qwebr-output-graph-area';

  // Append all elements to the main div
  mainDiv.appendChild(outputCodeAreaDiv);
  mainDiv.appendChild(outputGraphAreaDiv);

  return mainDiv;
};

// Function that adds a stub in the page to indicate a setup cell was used.
globalThis.qwebrCreateNonInteractiveSetupElement = function(qwebrCounter) {
  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = 'qwebr-noninteractive-setup-area-' + qwebrCounter;
  mainDiv.className = 'qwebr-noninteractive-setup-area';

  return mainDiv;
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/chapter1.html">Part 1: Probability</a></li><li class="breadcrumb-item"><a href="../notes/chapter4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probabilities with More than One Event</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Understanding Uncertainty</a> 
        <div class="sidebar-tools-main">
    <a href="../Understanding-Uncertainty.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Mathematical Foundations of Statistical Experiments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Core Concepts of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probabilities with More than One Event</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summarizing Statistical Experiments with Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Expected Value, Location Summaries, and Measures of Variability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Expectations and Variances with Multiple Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Named Discrete Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Continuous Random Variables</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">An Introduction to Descriptive Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Sampling Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Methods of Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Basics of Null Hypothesis Significance Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing and Confidence Intervals in Two Populations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/chapter17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#marginal-and-joint-probabilities" id="toc-marginal-and-joint-probabilities" class="nav-link active" data-scroll-target="#marginal-and-joint-probabilities"><span class="header-section-number">4.1</span> Marginal and Joint Probabilities</a></li>
  <li><a href="#what-are-conditional-probabilities" id="toc-what-are-conditional-probabilities" class="nav-link" data-scroll-target="#what-are-conditional-probabilities"><span class="header-section-number">4.2</span> What are Conditional Probabilities?</a></li>
  <li><a href="#using-conditional-probabilities" id="toc-using-conditional-probabilities" class="nav-link" data-scroll-target="#using-conditional-probabilities"><span class="header-section-number">4.3</span> Using Conditional Probabilities</a>
  <ul class="collapse">
  <li><a href="#the-multiplication-rule" id="toc-the-multiplication-rule" class="nav-link" data-scroll-target="#the-multiplication-rule"><span class="header-section-number">4.3.1</span> The Multiplication Rule</a></li>
  <li><a href="#partitions-and-the-law-of-total-probability" id="toc-partitions-and-the-law-of-total-probability" class="nav-link" data-scroll-target="#partitions-and-the-law-of-total-probability"><span class="header-section-number">4.3.2</span> Partitions and the Law of Total Probability</a></li>
  <li><a href="#bayes-theorem" id="toc-bayes-theorem" class="nav-link" data-scroll-target="#bayes-theorem"><span class="header-section-number">4.3.3</span> Bayes’ Theorem</a></li>
  </ul></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence"><span class="header-section-number">4.4</span> Independence</a></li>
  <li><a href="#sec-contingency-tables" id="toc-sec-contingency-tables" class="nav-link" data-scroll-target="#sec-contingency-tables"><span class="header-section-number">4.5</span> Contingency Tables</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs/loader.js"></script>
<script type="module" id="qwebr-monaco-editor-init">

  // Configure the Monaco Editor's loader
  require.config({
    paths: {
      'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs'
    }
  });
</script>
<script type="module">// Global dictionary to store Monaco Editor instances
const qwebrEditorInstances = {};

// Function that builds and registers a Monaco Editor instance    
globalThis.qwebrCreateMonacoEditorInstance = function (
    initialCode, 
    qwebrCounter) {

  // Retrieve the previously created document elements
  let runButton = document.getElementById(`qwebr-button-run-${qwebrCounter}`);
  let editorDiv = document.getElementById(`qwebr-editor-${qwebrCounter}`);
  
  // Load the Monaco Editor and create an instance
  let editor;
  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(editorDiv, {
      value: initialCode,
      language: 'r',
      theme: 'vs-light',
      automaticLayout: true,           // Works wonderfully with RevealJS
      scrollBeyondLastLine: false,
      minimap: {
        enabled: false
      },
      fontSize: '17.5pt',              // Bootstrap is 1 rem
      renderLineHighlight: "none",     // Disable current line highlighting
      hideCursorInOverviewRuler: true  // Remove cursor indictor in right hand side scroll bar
    });

    // Store the official counter ID to be used in keyboard shortcuts
    editor.__qwebrCounter = qwebrCounter;

    // Store the official div container ID
    editor.__qwebrEditorId = `qwebr-editor-${qwebrCounter}`;

    // Store the initial code value
    editor.__qwebrinitialCode = initialCode;

    // Dynamically modify the height of the editor window if new lines are added.
    let ignoreEvent = false;
    const updateHeight = () => {
      const contentHeight = editor.getContentHeight();
      // We're avoiding a width change
      //editorDiv.style.width = `${width}px`;
      editorDiv.style.height = `${contentHeight}px`;
      try {
        ignoreEvent = true;

        // The key to resizing is this call
        editor.layout();
      } finally {
        ignoreEvent = false;
      }
    };

    // Helper function to check if selected text is empty
    function isEmptyCodeText(selectedCodeText) {
      return (selectedCodeText === null || selectedCodeText === undefined || selectedCodeText === "");
    }

    // Registry of keyboard shortcuts that should be re-added to each editor window
    // when focus changes.
    const addWebRKeyboardShortCutCommands = () => {
      // Add a keydown event listener for Shift+Enter to run all code in cell
      editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {

        // Retrieve all text inside the editor
        qwebrExecuteCode(editor.getValue(), editor.__qwebrCounter);
      });

      // Add a keydown event listener for CMD/Ctrl+Enter to run selected code
      editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {

        // Get the selected text from the editor
        const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        // Check if no code is selected
        if (isEmptyCodeText(selectedText)) {
          // Obtain the current cursor position
          let currentPosition = editor.getPosition();
          // Retrieve the current line content
          let currentLine = editor.getModel().getLineContent(currentPosition.lineNumber);

          // Propose a new position to move the cursor to
          let newPosition = new monaco.Position(currentPosition.lineNumber + 1, 1);

          // Check if the new position is beyond the last line of the editor
          if (newPosition.lineNumber > editor.getModel().getLineCount()) {
            // Add a new line at the end of the editor
            editor.executeEdits("addNewLine", [{
            range: new monaco.Range(newPosition.lineNumber, 1, newPosition.lineNumber, 1),
            text: "\n", 
            forceMoveMarkers: true,
            }]);
          }
          
          // Run the entire line of code.
          qwebrExecuteCode(currentLine, editor.__qwebrCounter,
            EvalTypes.Interactive);

          // Move cursor to new position
          editor.setPosition(newPosition);
        } else {
          // Code to run when Ctrl+Enter is pressed with selected code
          qwebrExecuteCode(selectedText, editor.__qwebrCounter, EvalTypes.Interactive);
        }
      });
    }

    // Register an on focus event handler for when a code cell is selected to update
    // what keyboard shortcut commands should work.
    // This is a workaround to fix a regression that happened with multiple
    // editor windows since Monaco 0.32.0 
    // https://github.com/microsoft/monaco-editor/issues/2947
    editor.onDidFocusEditorText(addWebRKeyboardShortCutCommands);

    // Register an on change event for when new code is added to the editor window
    editor.onDidContentSizeChange(updateHeight);

    // Manually re-update height to account for the content we inserted into the call
    updateHeight();

    // Store the editor instance in the global dictionary
    qwebrEditorInstances[editor.__qwebrCounter] = editor;

  });

  // Add a click event listener to the run button
  runButton.onclick = function () {
    qwebrExecuteCode(editor.getValue(), editor.__qwebrCounter, EvalTypes.Interactive);
  };

}</script>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/chapter1.html">Part 1: Probability</a></li><li class="breadcrumb-item"><a href="../notes/chapter4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probabilities with More than One Event</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probabilities with More than One Event</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="marginal-and-joint-probabilities" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="marginal-and-joint-probabilities"><span class="header-section-number">4.1</span> Marginal and Joint Probabilities</h2>
<p>Up until this point we have primarily focused on assigning probabilities to particular events. If we have some event of interest, <span class="math inline">\(A\)</span>, then <span class="math inline">\(P(A)\)</span> is the probability that <span class="math inline">\(A\)</span> occurs in any manner. If we are using our equally likely probability model, then <span class="math inline">\(P(A) = \dfrac{N_A}{N}\)</span>. This is the probability of the event <span class="math inline">\(A\)</span> where nothing else is known at all. If we smooth over anything which could alter the likelihood, if we have no additional information, if we want the best guess for the likelihood of occurrence in a vacuum, this is the probability of interest. We refer to such quantities as marginal probabilities.</p>
<div id="def-marginal-probability" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.1 (Marginal Probability)</strong></span> The marginal probability of a single event, <span class="math inline">\(A\)</span>, is the probability that the event happens without considering any additional information. This is the probability that the event happens, denoted <span class="math inline">\(P(A)\)</span>.</p>
</div>
<p>It is useful to specifically call these marginal probabilities to differentiate them from probabilities which depend on two or more events. Specifically, we can think about taking the intersection of two events, say <span class="math inline">\(A \cap B\)</span>. In words this is the event that <span class="math inline">\(A\)</span> occurs <strong>and</strong> <span class="math inline">\(B\)</span> occurs. Until this point we have thought about solving for probabilities related to intersections as a two-step procedure: first, find an event <span class="math inline">\(C = A \cap B\)</span>, and then second solve for the marginal probability of <span class="math inline">\(C\)</span>. While this is a useful technique for calculation, sometimes it is more useful to think of the probability of the intersection as the probability of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> occurring simultaneously. We call this the joint probability of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<div id="def-joint-probability" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.2 (Joint Probability)</strong></span> The joint probability of two events, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, is given by the probability of their intersection. That is, <span class="math inline">\(P(A\cap B)\)</span>. This is sometimes denoted <span class="math inline">\(P(A,B)\)</span> and corresponds to the probability that both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> occur.</p>
<p>The joint probability of more than two events extends in the same way. Suppose there exists a sequence of events, <span class="math inline">\(A_1, \dots, A_n\)</span>, then the joint probability of these events is <span class="math display">\[P(A_1,A_2,\dots,A_n) = P\left(\bigcap_{i=1}^n A_i\right).\]</span></p>
</div>
</section>
<section id="what-are-conditional-probabilities" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="what-are-conditional-probabilities"><span class="header-section-number">4.2</span> What are Conditional Probabilities?</h2>
<p>Marginal probabilities are often of interest, and frequently are the best tool for summarizing the overall state of the world, or our knowledge regarding the state of the world. Joint probabilities can be useful when working with compound events, or thinking of complex outcomes. However, there are many scenarios which are not covered by either the joint or marginal probabilities. In practice we know that sometimes information that we have will change our understanding of the probability of an event.</p>
<p>Suppose the event <span class="math inline">\(A\)</span> corresponds to the event that it snows tomorrow, in some particular city. It is possible to think about how often it snows on average, and report a value related to that as <span class="math inline">\(P(A)\)</span>. Now, what if we know that it is currently the middle of summer, and the city is in the Norther Hemisphere? In this case, while <span class="math inline">\(P(A)\)</span> does not shrink to <span class="math inline">\(0\)</span>, it becomes far less likely than if we did not have that information. Similarly, if we know that it is winter in the same city, the likelihood that it snows tomorrow increases. In order to formally capture this we can introduce the idea of conditional probability.</p>
<div id="def-conditional-probability" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.3 (Conditional Probability)</strong></span> The conditional probability of an event <span class="math inline">\(A\)</span> given an event <span class="math inline">\(B\)</span>, is the probability that <span class="math inline">\(A\)</span> occurs assuming that we know that <span class="math inline">\(B\)</span> occurs. The conditional probability takes into account additional information codified through the occurrence of an additional event. We write this quantity as <span class="math inline">\(P(A|B)\)</span>, and will read this as “the probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span>.”</p>
</div>
<p>Unlike in the case of marginal probabilities, conditional probabilities allow us to <em>condition</em> on extra pieces of information. Instead of asking “what is the probability of this event”, we instead ask, “given that we know this piece of information, what is the probability of this event?” Joint probabilities ask “what is the probability that both of these events occur simultaneously” which is distinct in that we do not have any additional information about the state of the world when working with joint probabilities. The subtle distinction becomes quite powerful, both in terms of manipulating and working with probabilities, but also in terms of expressing the correct events of interest for ourselves.</p>
<p>To make use of conditional probabilities, we will think of the process of <em>conditioning</em> on one or more events. We will talk of the probability of <span class="math inline">\(A\)</span> conditional on <span class="math inline">\(B\)</span>, where <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are two events of interest. Intuitively, this it the probability of <span class="math inline">\(A\)</span> happening, supposing that we know that <span class="math inline">\(B\)</span> has already happened.</p>
<div id="exm-basic-conditional-probability" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.1 (Six from the Sum)</strong></span> Charles and Sadie are playing a new game using two dice. In the game they each take turns rolling the two dice into a container that the other player cannot see. They add up the dice and then report this sum to the other player. The other player then has to guess whether or not there is a six showing.</p>
<ol type="a">
<li>On one round, Charles does not hear the sum that Sadie reports as he was not paying attention. Sadie is strict and insists that she will not repeat herself. What should Charles guess?</li>
<li>Determine a strategy which optimizes the likelihood that the guessing player will be correct.</li>
</ol>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>In this case we want the <strong>marginal probability</strong> of a six showing up on the roll of two dice. Take <span class="math inline">\(E\)</span> to represent the event wherein at least one six is showing on the roll of two dice. Thus, <span class="math inline">\(E^C\)</span> is the event that no sixes are showing. There are <span class="math inline">\(5\times 5=25\)</span> (using the product rule for counting) ways of <em>not</em> rolling a <span class="math inline">\(6\)</span>, meaning that <span class="math display">\[P(E^C) = \dfrac{25}{36} \implies P(E) = 1 - \dfrac{25}{36} = \dfrac{11}{36}.\]</span> Thus, Charles should guess that there is no <span class="math inline">\(6\)</span> as the probability is only <span class="math inline">\(11/36 \approx 0.31\)</span>.</p></li>
<li><p>Here we wish to determine conditional probabilities. We take <span class="math inline">\(E\)</span> to be the event that at least one <span class="math inline">\(6\)</span> is showing, and then <span class="math inline">\(S\)</span> to be a variable representing the sum of the two dice. For <span class="math inline">\(s= 1, \dots, 12\)</span> we wish to find <span class="math inline">\(P(E|\{S=s\})\)</span>. Notice that for <span class="math inline">\(s=2,\dots,6\)</span> <span class="math inline">\(P(E|S=s) = 0\)</span>. If the sum is <span class="math inline">\(2\)</span> we know that there could not have been a <span class="math inline">\(6\)</span>. Moreover, for <span class="math inline">\(s=11,12\)</span> we know that <span class="math inline">\(P(E|S=s) = 1\)</span> since the only way to form <span class="math inline">\(11\)</span> is a five and a six, and the only way to form <span class="math inline">\(12\)</span> is to have two sixes. This leaves <span class="math inline">\(s = 7,\dots,10\)</span> to check. The following table gives the set of values, the possible combinations to reach the value, and then the combinations that end up involving a <span class="math inline">\(6\)</span>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Value</th>
<th>Combinations</th>
<th>Involving 6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>(1,6) (2,5) (3, 4) (4, 3) (5, 2) (6, 1)</td>
<td>(1, 6) (6, 1)</td>
</tr>
<tr class="even">
<td>8</td>
<td>(2,6) (3,5) (4, 4) (5, 3) (6, 2)</td>
<td>(2, 6) (6, 2)</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(3,6) (4,5) (5, 4) (6, 3)</td>
<td>(2, 6) (6, 2)</td>
</tr>
<tr class="even">
<td>10</td>
<td>(4, 6) (5, 5) (6, 4)</td>
<td>(4, 6) (6, 4)</td>
</tr>
</tbody>
</table>
<p>Referencing from this table we can read off the following probabilities <span class="math display">\[\begin{align*}
P(E|S=7) &amp;= \dfrac{2}{6} = \dfrac{1}{3}\\
P(E|S=8) &amp;= \dfrac{2}{5} \\
P(E|S=9) &amp;= \dfrac{2}{4} \\
P(E|S=10) &amp;= \dfrac{2}{3}.
\end{align*}\]</span> As a result, the best strategy is to guess “yes” when a <span class="math inline">\(10\)</span>, <span class="math inline">\(11\)</span>, or <span class="math inline">\(12\)</span> is rolled and to be indifferent to the guess when a <span class="math inline">\(9\)</span> is rolled. Otherwise, guess “no.”</p></li>
</ol>
</div>
</div>
</div>
</div>
<p>Recall that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, as events, are merely subsets of the sample space, <span class="math inline">\(\mathcal{S}\)</span>. Each item in either <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span> is one of the possible outcomes from the experiment or process that we are observing. Suppose that we know that <span class="math inline">\(B\)</span> has occurred. What this means is that, one of the outcomes in the set <span class="math inline">\(B\)</span> was the observed outcome from the experiment. Now, if we want to know <span class="math inline">\(P(A|B)\)</span>, we want to know the probability, working from the assumption that <span class="math inline">\(B\)</span> has happened, that <span class="math inline">\(A\)</span> also happens. That is, knowing that <span class="math inline">\(B\)</span> has happened, what is the probability that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> both happen.</p>
<p>The event that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> both happen is denoted by the intersection, <span class="math inline">\(A \cap B\)</span>. This corresponds to the set of events inside the set <span class="math inline">\(B\)</span> which also belong to the set <span class="math inline">\(A\)</span>. Now, instead of considering the joint probability directly, we need to acknowledge that for <span class="math inline">\(A|B\)</span>, only the events in <span class="math inline">\(B\)</span> were possible. That is, instead of being divided by the whole space, we can only divide by the space of <span class="math inline">\(B\)</span>. In some sense, we can view conditioning on <span class="math inline">\(B\)</span> as treating <span class="math inline">\(B\)</span> as though it is the full sample space, and finding probabilities within that. In general, <span class="math inline">\(B\)</span> will be smaller than <span class="math inline">\(\mathcal{S}\)</span>, and so <span class="math inline">\(P(B) &lt; 1\)</span>. Instead of the conditional probability being “out of” <span class="math inline">\(1\)</span>, it will instead be “out of” <span class="math inline">\(P(B)\)</span>, which gives <span class="math inline">\(P(A|B) = \dfrac{P(A\cap B)}{P(B)}\)</span>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Computing Conditional Probabilities
</div>
</div>
<div class="callout-body-container callout-body">
<p>For an event <span class="math inline">\(A\)</span>, and an event <span class="math inline">\(B\)</span> with probability <span class="math inline">\(P(B) &gt; 0\)</span>, the conditional probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span> is <span class="math display">\[P(A|B) = \dfrac{P(A\cap B)}{P(B)}.\]</span></p>
</div>
</div>
<p>To make this more clear, suppose that we take <span class="math inline">\(A\)</span> to be the event that a <span class="math inline">\(2\)</span> is rolled on a fair, six-sided die, and <span class="math inline">\(B\)</span> to be the event that an even number was rolled. This is an equal probability model, and so each outcome gets <span class="math inline">\(\dfrac{1}{6}\)</span> probability. The original sample space is <span class="math inline">\(\mathcal{S} = \{1,2,3,4,5,6\}\)</span>, the event <span class="math inline">\(A\)</span> is <span class="math inline">\(\{2\}\)</span>, and the event <span class="math inline">\(B\)</span> is <span class="math inline">\(\{2,4,6\}\)</span>. In order for both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> to occur, we note that we need <span class="math inline">\(A \cap B = \{2\}\)</span>. If we know that <span class="math inline">\(B\)</span> has occurred, then we know that either a <span class="math inline">\(2\)</span>, <span class="math inline">\(4\)</span>, or <span class="math inline">\(6\)</span> has been rolled, with equal probability for each. Thus, intuitively, we can view <span class="math inline">\(B\)</span> as the new sample space, and say that rolling a <span class="math inline">\(2\)</span> has a <span class="math inline">\(\dfrac{1}{3}\)</span> probability, given that there are <span class="math inline">\(3\)</span> outcomes and <span class="math inline">\(1\)</span> of them is the event of interest.</p>
<p>We can also compute this directly. Note that <span class="math inline">\(P(B) = \dfrac{1}{2}\)</span>, and so we need to scale each event by <span class="math inline">\(\dfrac{1}{1/2}\)</span> in order to make sure that the total probability of our reduced sample space equals <span class="math inline">\(1\)</span>. Then <span class="math inline">\(P(A\cap B) = \dfrac{1}{6}\)</span>, so <span class="math display">\[P(A|B) = \dfrac{1/6}{1/2} = \dfrac{1}{3}.\]</span></p>
<p>Suppose that, instead of a fair die, it was weighted so that <span class="math inline">\(6\)</span> comes up more frequently than the other options. Consider the probability of observing a six to be <span class="math inline">\(0.5\)</span>, with the other five values each coming up with probability <span class="math inline">\(0.10\)</span>. If <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are the same events as above, then <span class="math inline">\(P(B) = 0.7\)</span>.</p>
<p>If we know that <span class="math inline">\(B\)</span> has occurred then the new sample space is <span class="math inline">\(\{2,4,6\}\)</span> where <span class="math inline">\(P(2) = \dfrac{0.1}{0.7} = \dfrac{1}{7}\)</span>, <span class="math inline">\(P(4) = \dfrac{0.1}{0.7} = \dfrac{1}{7}\)</span>, and <span class="math inline">\(P(6) = \dfrac{0.5}{0.7} = \dfrac{5}{7}\)</span>. Note that these three probabilities sum to <span class="math inline">\(1\)</span> still, which constitutes a valid probability model, and so <span class="math inline">\(P(A|B) = \dfrac{1}{7}\)</span>.</p>
<div id="exm-basic-conditional-probability-rev" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.2 (Six from the Sum - Revisited)</strong></span> Sadie sees the solution worked out for the best strategy in the dice game above, but is having trouble understanding it in the context of conditional probability more broadly. For the sums <span class="math inline">\(7, 8, 9\)</span>, and <span class="math inline">\(10\)</span>, describe the process of limiting the sample space to get the correct conditional probability, and use the formula to show that the probabilities worked out in <a href="#exm-basic-conditional-probability" class="quarto-xref">Example&nbsp;<span>4.1</span></a> are correct.</p>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The relevant table of solutions is copied from above.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Value</th>
<th>Combinations</th>
<th>Involving 6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>(1,6) (2,5) (3, 4) (4, 3) (5, 2) (6, 1)</td>
<td>(1, 6) (6, 1)</td>
</tr>
<tr class="even">
<td>8</td>
<td>(2,6) (3,5) (4, 4) (5, 3) (6, 2)</td>
<td>(2, 6) (6, 2)</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(3,6) (4,5) (5, 4) (6, 3)</td>
<td>(2, 6) (6, 2)</td>
</tr>
<tr class="even">
<td>10</td>
<td>(4, 6) (5, 5) (6, 4)</td>
<td>(4, 6) (6, 4)</td>
</tr>
</tbody>
</table>
<p>Here, given a sum, we <strong>know</strong> that one of the events listed under “combinations” has occurred. As a result, once we have conditioned on what the sum is, we are able to treat the “combinations” column as the full sample space of possible outcomes. Each of these in this case is equally likely, and so we can divide the number which contain a <span class="math inline">\(6\)</span>, by the total number in the reduced sample space.</p>
<p>To do this algebraically, we first note that <span class="math display">\[\begin{align*}
    P(S=7) &amp;= \dfrac{6}{36} \\
    P(S=8) &amp;= \dfrac{5}{36} \\
    P(S=9) &amp;= \dfrac{4}{36} \\
    P(S=10) &amp;= \dfrac{3}{36}.
\end{align*}\]</span> Now, suppose we consider the event <span class="math inline">\(E\cap\{S=7\}\)</span>. This is the set <span class="math inline">\(\{(1,6),(6,1)\}\)</span> and so <span class="math inline">\(P(E\cap\{S=7\}) = 2/36\)</span>. In fact, the same holds true for all of the joint events. As a result, we get <span class="math display">\[\begin{align*}
    P(E|S=7) &amp;= \dfrac{\dfrac{2}{36}}{\dfrac{6}{36}} = \dfrac{2}{6} \\
    P(E|S=8) &amp;= \dfrac{\dfrac{2}{36}}{\dfrac{5}{36}} = \dfrac{2}{5} \\
    P(E|S=9) &amp;= \dfrac{\dfrac{2}{36}}{\dfrac{4}{36}} = \dfrac{2}{4} \\
    P(E|S=10) &amp;= \dfrac{\dfrac{2}{36}}{\dfrac{3}{36}} = \dfrac{2}{3}.
\end{align*}\]</span> This corresponds exactly to the values we found before.</p>
</div>
</div>
</div>
</div>
<p>Sometimes, we wish to condition on more than one event. To do so, the same process extends naturally. For instance, suppose we want to know the probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>. This would be written <span class="math display">\[P(A|B,C) = \dfrac{P(A\cap B\cap C)}{P(B \cap C)} = \dfrac{P(A,B,C)}{P(B,C)}.\]</span> Moving beyond two events occurs in the expected way.</p>
</section>
<section id="using-conditional-probabilities" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="using-conditional-probabilities"><span class="header-section-number">4.3</span> Using Conditional Probabilities</h2>
<p>Conditional probability is a mechanism for capturing our knowledge of the world, and using that to update our sense of the uncertainties at play. For instance, suppose that we are interested in drawing a random card from a deck of <span class="math inline">\(52\)</span>, and we want to know the probability that it is a heart. Without any additional knowledge, the probability of this event is <span class="math inline">\(\dfrac{1}{4}\)</span>. Now, suppose that you know that it is a red card. In this case, we now know that it is either a heart or a diamond, and there are equal numbers of each, meaning that the new probability is <span class="math inline">\(0.5\)</span>. We can work this out directly <span class="math display">\[P(\text{Heart}|\text{Red}) = \dfrac{P(\text{Heart},\text{Red})}{P(\text{Red})} = \dfrac{P(\text{Heart})}{1/2} = \dfrac{1/4}{1/2} = 0.5.\]</span> Suppose instead that we had been told that the card was an ace. Here we now know that there are four possible outcomes that correspond to an ace, and only one of these is a heart, meaning the probability is <span class="math inline">\(\dfrac{1}{4}\)</span>. In this case, <span class="math inline">\(P(A|B) = P(A)\)</span>, and our beliefs did not update.</p>
<p>What if instead we had considered the second event to be “the card was a spade.” In this case if we want to know <span class="math inline">\(P(A|B)\)</span> then, given a spade being drawn, we know that the probability of drawing a heart is <span class="math inline">\(0\)</span>.</p>
<div id="exm-conditional-probability-urn" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.3 (Charles’s Mismatched Urn Mishap)</strong></span> Charles’s love of probability prompts a spontaneous decision: buy an urn and some coloured balls to fill it up with. Unfortunately, the supplier of the balls misunderstood the request and sent over an assortment of different shapes rather than just spheres. There are some spheres, some cubes, some pyramids, and some cones. There are also five different colours present, red, blue, green, yellow, and black. Charles is slightly dismayed as, when reaching into the urn, it is very easy to feel what shape you are pulling out before you see the object, and the distribution of colour-shape combinations is not even. Despite the dismay, Charles shows Sadie, who is deeply excited, explaining how this mismatched urn is perfect for understanding conditional probabilities deeply. The distribution of shapes and colours is presented in the following table.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Colour</strong></th>
<th style="text-align: center;"><strong>Sphere</strong></th>
<th style="text-align: center;"><strong>Cube</strong></th>
<th style="text-align: center;"><strong>Pyramid</strong></th>
<th style="text-align: center;"><strong>Cone</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Red</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td><strong>Blue</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td><strong>Green</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td><strong>Yellow</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td><strong>Black</strong></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>What is the probability of drawing each colour, if items are selected at random, without knowledge of the shape?</li>
<li>Assuming that the shape is known, what is the probability of selecting each colour?</li>
</ol>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>Note that there are <span class="math inline">\(2+3+2=7\)</span> red, <span class="math inline">\(1+6=7\)</span> blue, <span class="math inline">\(2+2+1+2=7\)</span> green, <span class="math inline">\(4+2+1=7\)</span> yellow, and <span class="math inline">\(3+1+1+2=7\)</span> black objects. As a result, each colour is going to be equally likely, with a probability of <span class="math inline">\(0.2\)</span>.</p></li>
<li><p>Take <span class="math inline">\(S\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(P\)</span>, <span class="math inline">\(Cn\)</span> to be the events that a sphere, cube, pyramid, or cone are drawn, respectively. Take <span class="math inline">\(R\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(G\)</span>, <span class="math inline">\(Y\)</span>, <span class="math inline">\(Bk\)</span> to be the events that a red, blue, green, yellow, or black object is drawn, respectively. We want the probability of each colour, given the corresponding shape. There are a total of <span class="math inline">\(20\)</span> conditional probabilities to solve for here. We walk through, in full, the first conditional probability calculation. Afterwards, the same process follows to get the (provided) answer.</p>
<p>First note that there are <span class="math inline">\(8\)</span> spheres, <span class="math inline">\(10\)</span> cubes, <span class="math inline">\(6\)</span> pyramids, and <span class="math inline">\(11\)</span> cones. Thus, the marginal probabilities are <span class="math inline">\(P(S) = 8/35\)</span>, <span class="math inline">\(P(C) = 10/35\)</span>, <span class="math inline">\(P(P) = 6/35\)</span>, and <span class="math inline">\(P(Cn) = 11/35\)</span>. Note further that the joint probability between any colour-shape combination is going to be given by the number of that combination that exist, divided by <span class="math inline">\(35\)</span>. Thus, suppose we want <span class="math inline">\(P(R|S)\)</span>. There are <span class="math inline">\(2\)</span> red spheres, so <span class="math inline">\(P(R \cap S) = 2/35\)</span>. The marginal probability <span class="math inline">\(P(S) = 8/35\)</span>, so taken together this gives <span class="math display">\[P(R|S) = \dfrac{2/35}{8/35} = \dfrac{2}{8} = \dfrac{1}{4}.\]</span></p>
<p>Applying the same process gives the following probabilities, reported in the table for convenience.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Colour</strong></th>
<th style="text-align: center;"><strong>Sphere</strong></th>
<th style="text-align: center;"><strong>Cube</strong></th>
<th style="text-align: center;"><strong>Pyramid</strong></th>
<th style="text-align: center;"><strong>Cone</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Red</strong></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{2}{8} = \dfrac{1}{4}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{3}{10}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{3}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td><strong>Blue</strong></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{8}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{6}{11}\)</span></td>
</tr>
<tr class="odd">
<td><strong>Green</strong></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{2}{8} = \dfrac{1}{4}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{5}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{6}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{2}{11}\)</span></td>
</tr>
<tr class="even">
<td><strong>Yellow</strong></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{2}{5}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{3}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{11}\)</span></td>
</tr>
<tr class="odd">
<td><strong>Black</strong></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{3}{8}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{10}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{1}{6}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{2}{11}\)</span></td>
</tr>
</tbody>
</table></li>
</ol>
</div>
</div>
</div>
</div>
<section id="the-multiplication-rule" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="the-multiplication-rule"><span class="header-section-number">4.3.1</span> The Multiplication Rule</h3>
<p>While sometimes we will want to work out the conditional probability using our knowledge of the joint and marginal probabilities, there are other times where it is easier to determine the conditional probability directly. In these settings we may wish to understand the marginal or joint probabilities. That is, we may know <span class="math inline">\(P(A|B)\)</span>, but we want to make statements regarding <span class="math inline">\(P(A)\)</span> or <span class="math inline">\(P(A,B)\)</span>.</p>
<p>To do so, we can rearrange the defining relationship of conditional probability, to solve for the quantities of interest. Because of the importance of this procedure, we actually give this mostly straightforward rearrangement a special name.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Multiplication Rule
</div>
</div>
<div class="callout-body-container callout-body">
<p>The multiplication rule states that, for two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> where <span class="math inline">\(P(B) &gt; 0\)</span>, <span class="math display">\[P(A\cap B) = P(A|B)P(B).\]</span></p>
</div>
</div>
<p>Note that, by multiplying both sides of the definition of <span class="math inline">\(P(A|B)\)</span> by <span class="math inline">\(P(B)\)</span> gives the result. In words it states that we can solve for the joint probability of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> by multiplying the conditional probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span>, by the marginal probability of <span class="math inline">\(B\)</span>. This is symmetric in <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> so that <span class="math display">\[P(A\cap B) = P(B|A)P(A).\]</span> This is useful as sometimes it is easier to determine <span class="math inline">\(B\)</span> given <span class="math inline">\(A\)</span>.</p>
<div id="exm-package-delivery-times" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.4 (Package Delivery Times)</strong></span> To thank Sadie for the help in seeing the silver lining with the urn mishap, Charles decides to order a small gift online, sending it direct to Sadie. Unfortunately, the website does not list which delivery company each package is sent out with. After some sleuthing, Charles determines that there are two different companies that it may have been sent with. Looking at online reviews it appears as though company <span class="math inline">\(A\)</span> is late <span class="math inline">\(75\%\)</span> of the time while company <span class="math inline">\(B\)</span> is late <span class="math inline">\(15\%\)</span> of the time.</p>
<p>If the store that Charles ordered from sends out <span class="math inline">\(10\%\)</span> of packages with company <span class="math inline">\(A\)</span>, and the rest with company <span class="math inline">\(B\)</span>, which is more likely: that the package is late and was sent with <span class="math inline">\(A\)</span>, or that the package was late and sent with <span class="math inline">\(B\)</span>?</p>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will take <span class="math inline">\(L\)</span> to correspond to the events where the package is late, <span class="math inline">\(A\)</span> to the events where the package was sent with <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> to be the events where the package was sent with <span class="math inline">\(B\)</span>. We wish to compare <span class="math inline">\(P(L, A)\)</span> and <span class="math inline">\(P(L, B)\)</span>. We know that <span class="math inline">\(P(A) = 0.1\)</span> and <span class="math inline">\(P(B) = 0.9\)</span>, and we know that <span class="math inline">\(P(L|A) = 0.75\)</span> and <span class="math inline">\(P(L|B) = 0.15\)</span>. As a result, we can use the multiplication rule to find the joint probabilities.</p>
<p>First, <span class="math display">\[P(L, A) = P(L|A)P(A) = (0.75)(0.1) = 0.075.\]</span> Additionally, <span class="math display">\[P(L, B) = P(L|B)P(B) = (0.15)(0.9) = 0.135.\]</span></p>
<p>As a result it is more likely to have the package late and sent with <span class="math inline">\(B\)</span> then the package late and sent with <span class="math inline">\(A\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
</div>
</div>
</div>
</section>
<section id="partitions-and-the-law-of-total-probability" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="partitions-and-the-law-of-total-probability"><span class="header-section-number">4.3.2</span> Partitions and the Law of Total Probability</h3>
<p>While the multiplication rule gives us the capacity to solve for joint probabilities, often we wish to make statements regarding marginal probabilities. Fortunately, we can extend the process outlined in the multiplication rule to solve directly for marginal probabilities as well. To do so, we first introduce the concept of a partition.</p>
<div id="def-partition" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.4 (Partition)</strong></span> A partition is a collection of sets which divide up the sample space such that all of the sets are disjoint from one another, and the sample space is given by the union of all of the sets. That is, <span class="math inline">\(A_1,\dots,A_n\)</span> is a partition of <span class="math inline">\(\mathcal{S}\)</span> if:</p>
<ol type="1">
<li><span class="math inline">\(A_i \cap A_j = \emptyset\)</span> for all <span class="math inline">\(i \neq j\)</span>, and</li>
<li><span class="math display">\[\bigcup_{i=1}^n A_i = \mathcal{S}.\]</span></li>
</ol>
</div>
<p>For instance, if the sample space were all the positive integers, we could partition this space into all the even numbers as one set and all the odd numbers as a second. We could also partition this into the set of numbers which are less than <span class="math inline">\(10\)</span>, the set of numbers that are greater than <span class="math inline">\(10\)</span>, and then <span class="math inline">\(10\)</span>. In both examples we have sets whose union forms the full sample space with no overlap. Note that we could not partition the set into multiples of <span class="math inline">\(2\)</span> and multiples of <span class="math inline">\(3\)</span>, since (i) not all values are contained between these two sets,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> and (ii) there is overlap between these two sets.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div id="exm-simple-partitions" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.5 (Partitions of the Coin Game)</strong></span> Charles and Sadie are thinking back with fondness to their original coin flipping game, where they would toss a coin three times in a row. If two or more heads showed up, Charles would pay. Otherwise, Sadie would.</p>
<p>To help them reminisce, write down three different partitions of the sample space, each with a different number of partitioning sets. Describe your partitions using words.</p>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are many possible partitions to write down. The following are examples.</p>
<ol type="1">
<li><p>We can partition the space into games where Charles pays and games where Sadie pays. This gives <span class="math display">\[\begin{align*}
B_1 &amp;= \{(\text{H},\text{H},\text{H}), (\text{H},\text{H},\text{T}), (\text{H},\text{T},\text{H}), (\text{T},\text{H},\text{H})\}\\
B_2 &amp;= \{(\text{T},\text{T},\text{T}), (\text{T},\text{T},\text{H}), (\text{T},\text{H},\text{T}), (\text{H},\text{T},\text{T})\}.\end{align*}\]</span></p></li>
<li><p>We can partition the space into those with <span class="math inline">\(0\)</span>, <span class="math inline">\(1\)</span>, <span class="math inline">\(2\)</span>, or <span class="math inline">\(3\)</span> heads. This gives <span class="math display">\[\begin{align*}
B_1 &amp;= \{(\text{H},\text{H},\text{H})\}\\
B_2 &amp;= \{(\text{T},\text{T},\text{H}), (\text{T},\text{H},\text{T}), (\text{H},\text{T},\text{T})\}\\
B_3 &amp;= \{(\text{H},\text{H},\text{T}), (\text{H},\text{T},\text{H}), (\text{T},\text{H},\text{H})\}\\
B_4 &amp;= \{(\text{H},\text{H},\text{H})\}.
\end{align*}\]</span></p></li>
<li><p>We can partition the space into the number of times the sequence switches between heads and tails. There will be either <span class="math inline">\(0\)</span> switches, <span class="math inline">\(1\)</span> switch, or <span class="math inline">\(2\)</span> switches. This gives <span class="math display">\[\begin{align*}
B_1 &amp;= \{(\text{H},\text{H},\text{H}), (\text{H},\text{H},\text{H})\}\\
B_2 &amp;= \{(\text{T},\text{T},\text{H}), (\text{H},\text{T},\text{T}), (\text{H},\text{H},\text{T}), (\text{T},\text{H},\text{H})\}\\
B_3 &amp;= \{(\text{T},\text{H},\text{T}),  (\text{H},\text{T},\text{H})\}.
\end{align*}\]</span></p></li>
</ol>
</div>
</div>
</div>
</div>
<p>Partitions allow us to move from discussions regarding the joint probability of events to the marginal probability of an event. Suppose that we have a partition given by <span class="math inline">\(B_1, B_2, \dots\)</span>. This means that our full sample space can be cut up into these various non-overlapping sets, and every single outcome belongs to exactly one of them. Now, suppose we are interested in some other event <span class="math inline">\(A\)</span>. We can ask: how can <span class="math inline">\(A\)</span> occur, in terms of the events <span class="math inline">\(B_1, B_2, \dots\)</span>?</p>
<p>Since every single event in the sample space belongs to exactly one of our partitioning sets, then it <strong>must</strong> be the case that every single event in <span class="math inline">\(A\)</span> belongs to exactly one of our partitioning sets. This means that if we consider <span class="math inline">\(A\cap B_j\)</span>, for all <span class="math inline">\(j\)</span>, then every single event in <span class="math inline">\(A\)</span> must belong to exactly one of these. In other words, it must be the case that <span class="math display">\[A = \bigcup_{j} A\cap B_j,\]</span> for any partition <span class="math inline">\(B_1, B_2,\dots\)</span>. Moreover, every single <span class="math inline">\(A\cap B_j\)</span> is disjoint from every other <span class="math inline">\(A \cap B_\ell\)</span>, whenever <span class="math inline">\(\ell \neq j\)</span>. This means that we can use the axiom of additivity to give <span class="math display">\[P(A) = P\left(\bigcup_{j} A\cap B_j\right) = \sum_{j} P(A \cap B_j).\]</span> In other words: the marginal probability of <span class="math inline">\(A\)</span> can be found by summing over <strong>all</strong> joint probabilities between <span class="math inline">\(A\)</span> and sets that form a partition. This argument gives the law of total probability.</p>
<div id="fig-basic-partition" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-basic-partition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: This graphic shows the argument that summing over the joint probabilities between an event and a partition gives the full marginal probability. Note that <span class="math inline">\(B_1,\dots,B_7\)</span> forms a partition of the space where every possible outcome is contained in exactly one of these sets. Then, if we take an arbitrary event <span class="math inline">\(A\)</span>, we can divide <span class="math inline">\(A\)</span> into the components that intersect with each partitioning set, namely <span class="math inline">\(A \cap B_1\)</span>, <span class="math inline">\(A \cap B_2\)</span>, and so forth.
</figcaption>
<div aria-describedby="fig-basic-partition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../graphics/ch4-basic-partition.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;4.1: This graphic shows the argument that summing over the joint probabilities between an event and a partition gives the full marginal probability. Note that B_1,\dots,B_7 forms a partition of the space where every possible outcome is contained in exactly one of these sets. Then, if we take an arbitrary event A, we can divide A into the components that intersect with each partitioning set, namely A \cap B_1, A \cap B_2, and so forth."><img src="../graphics/ch4-basic-partition.svg" class="img-fluid figure-img"></a>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Law of Total Probability
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a partition, <span class="math inline">\(B_1, B_2, \dots\)</span>, and an event <span class="math inline">\(A\)</span>, the law of total probability states that <span class="math display">\[P(A) = \sum_i P(A, B_i) = \sum_i P(A|B_i)P(B_i).\]</span></p>
</div>
</div>
<p>Intuitively, since the whole sample space is divided into the different <span class="math inline">\(B_i\)</span>s, this rule breaks down the calculation of <span class="math inline">\(A\)</span> happening into manageable chunks. Each term in the summation is “the probability that <span class="math inline">\(A\)</span> happens, given <span class="math inline">\(B_i\)</span> happening” weighted by how likely it is that <span class="math inline">\(B_i\)</span> happens. Then by summing over all possible <span class="math inline">\(B_i\)</span>, we know that we must be capturing all possible ways that <span class="math inline">\(A\)</span> can occur since all parts of the sample space are contained in exactly one of the sets of our partition. The law of total probability is an indispensible tool for computing probabilities in practice.</p>
<div id="exm-lotp-example" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.6 (Sadie’s Possibly Late Package)</strong></span> Sadie has still not received the package that Charles had ordered. While it is not late yet, Charles decides to figure out the probability that the package will end up being late. Recall that company <span class="math inline">\(A\)</span> is late <span class="math inline">\(75\%\)</span> of the time while company <span class="math inline">\(B\)</span> is late <span class="math inline">\(15\%\)</span> of the time, and the store that Charles ordered from sends out <span class="math inline">\(10\%\)</span> of packages with company <span class="math inline">\(A\)</span>, and the rest with company <span class="math inline">\(B\)</span>, which is more likely.</p>
<p>What is the probability that the package arrives late?</p>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Note that <span class="math inline">\(A, B\)</span> forms a partition of the sample space as every package is either sent with <span class="math inline">\(A\)</span> or with <span class="math inline">\(B\)</span>, and no package can be sent with both. Further, if <span class="math inline">\(L\)</span> represents the event that the package is late, then we know that <span class="math inline">\(P(L|A) = 0.75\)</span> and <span class="math inline">\(P(L|B) = 0.15\)</span>. Since <span class="math inline">\(P(A) = 0.1\)</span> and <span class="math inline">\(P(B) = 0.9\)</span>, an application of the law of total probability gives <span class="math display">\[P(L) = P(L|A)P(A) + P(L|B)P(B) = (0.75)(0.1) + (0.15)(0.9) = 0.21.\]</span> As a result, knowing nothing else, the package has a probability of <span class="math inline">\(0.21\)</span> of being late.</p>
</div>
</div>
</div>
</div>
<div id="exm-lotp-example-two" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.7 (Charles’ Many Urns)</strong></span> While shopping at some garage sales one Sunday morning, Charles and Sadie stumble across a wonderful find! They see three urns which are <strong>exactly</strong> identical to the one that Charles had already purchased to store the different balls which turned out to not be balls at all. Realizing the opportunity they splurge and purchase them all, and then divide the various objects between the four urns, placing all the spheres in one container, all the cubes in another, all the pyramids in a third, and all the cones in a fourth.</p>
<p>Once done, they use a different selection mechanism. First, they pick an urn at random. Next, they randomly grab one of the items from within it. The distribution of colours and shapes is included in the following table.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Colour</strong></th>
<th style="text-align: center;"><strong>Sphere (Urn 1)</strong></th>
<th style="text-align: center;"><strong>Cube (Urn 2)</strong></th>
<th style="text-align: center;"><strong>Pyramid (Urn 3)</strong></th>
<th style="text-align: center;"><strong>Cone (Urn 4)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Red</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td><strong>Blue</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td><strong>Green</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td><strong>Yellow</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td><strong>Black</strong></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>What is the probability that they select any of the five colours under this sampling scheme?</li>
<li>How does this change if the probability that each urn is selected is proportional to the number of items in it? (Thus, urn 1 is selected with probability <span class="math inline">\(8/35\)</span>, and so forth).</li>
</ol>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>Let <span class="math inline">\(R\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(G\)</span>, <span class="math inline">\(Y\)</span>, and <span class="math inline">\(Bk\)</span> be the events that a red, blue, green, yellow, or black ball are selected. Further, let <span class="math inline">\(U_1\)</span>, <span class="math inline">\(U_2\)</span>, <span class="math inline">\(U_3\)</span>, and <span class="math inline">\(U_4\)</span> be the events that the first, second, third, or fourth urn are selected. Then note that, according to the law of total probability, <span class="math display">\[P(R) = P(R, U_1) + P(R, U_2) + P(R, U_3) + P(R, U_4) = \sum_{j=1}^4 P(R|U_j)P(U_j).\]</span> An equivalent argument holds for each of the other colours. Now, <span class="math display">\[P(R|U_j) = \dfrac{N_{R\cap U_j}}{N_{U_j}},\]</span> where <span class="math inline">\(N_{R\cap U_j}\)</span> is the number of red objects in urn <span class="math inline">\(j\)</span> and <span class="math inline">\(N_{U_j}\)</span> is the total number in urn <span class="math inline">\(j\)</span>. Plugging this in and simplifying we get <span class="math display">\[P(R) = \sum_{j=1}^4P(R|U_j)\left(\dfrac{1}{4}\right) = \dfrac{1}{4}\left\{\dfrac{2}{8} + \dfrac{3}{10} + \dfrac{2}{6}\right\} = \dfrac{53}{240}.\]</span></p>
<p>We can apply analogous arguments to the other colours giving <span class="math display">\[\begin{align*}
P(B) &amp;= \dfrac{1}{4}\left\{\dfrac{1}{8} + \dfrac{6}{11}\right\} = \dfrac{59}{352} \\
P(G) &amp;= \dfrac{1}{4}\left\{\dfrac{2}{8} + \dfrac{2}{10} + \dfrac{1}{6} + \dfrac{2}{11}\right\} = \dfrac{527}{2640}\\
P(Y) &amp;= \dfrac{1}{4}\left\{\dfrac{4}{10} + \dfrac{2}{6} + \dfrac{1}{11}\right\} = \dfrac{34}{165}\\
P(Bk) &amp;= \dfrac{1}{4}\left\{\dfrac{3}{8} + \dfrac{1}{10} + \dfrac{1}{6} + \dfrac{2}{11}\right\} = \dfrac{1087}{5280}.
\end{align*}\]</span></p>
<p>Note that these probabilities sum to <span class="math inline">\(1\)</span>. In decimal these simplify to approximately 0.221, 0.168, 0.2, 0.206, 0.206.</p></li>
<li><p>Using the same setup as before, we have <span class="math display">\[P(R) = P(R, U_1) + P(R, U_2) + P(R, U_3) + P(R, U_4) = \sum_{j=1}^4 P(R|U_j)P(U_j).\]</span> Now <span class="math inline">\(P(U_1) = 8/35\)</span>, <span class="math inline">\(P(U_2) = 10/35\)</span>, <span class="math inline">\(P(U_3) = 6/35\)</span>, and <span class="math inline">\(P(U_4) = 11/35\)</span>. Moreover, the conditional probabilities themselves do not change, and so instead we have <span class="math display">\[P(R) = \left\{\dfrac{2}{8}\cdot\dfrac{8}{35} + \dfrac{3}{10}\cdot\dfrac{10}{35} + \dfrac{2}{6}\dfrac{6}{35} + \dfrac{0}{11}\cdot\dfrac{11}{35}\right\} = \dfrac{N_R}{35}.\]</span> Note that when multiplying by the marginal probability of the urn, the denominator will always cancel. As a result, we end up with the total number of reds over <span class="math inline">\(35\)</span>, which leads to <span class="math inline">\(P(R) = \dfrac{1}{5}\)</span>. The same will be true for the other colours, and as a result, if we choose the urn based on a weighted selection, this will result in equal probability once more.</p></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="bayes-theorem" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="bayes-theorem"><span class="header-section-number">4.3.3</span> Bayes’ Theorem</h3>
<p>We have seen the direct computation of marginal probabilities (while using an equally likely outcome model), the computation of conditional probabilities, the use of the multiplication rule for joint probabilities, and the use of the law of total probability to indirectly calculate marginal probabilities through conditioning arguments. Throughout these discussions we have been primarily concerned with keeping events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> arbitrary. Everything that we have indicated for <span class="math inline">\(P(A)\)</span> holds for <span class="math inline">\(P(B)\)</span>, as does <span class="math inline">\(P(A|B)\)</span> and <span class="math inline">\(P(B|A)\)</span>. In reality, it will often be the case that conditioning on one of the events will be natural, while conditioning on the other will be more tricky. In these events, it can be useful to be able to transform statements regarding <span class="math inline">\(P(A|B)\)</span> into statements regarding <span class="math inline">\(P(B|A)\)</span>, and vice versa.</p>
<p>Note that because the definitions are symmetric, <span class="math display">\[P(A|B)P(B) = P(A,B) = P(B|A)P(A).\]</span> This is an application of the multiplication rule in two different orientations. If we divide both sides of the equality by <span class="math inline">\(P(B)\)</span>, assuming that it is not <span class="math inline">\(0\)</span>, then we get <span class="math display">\[P(A|B) = \dfrac{P(B|A)P(A)}{P(B)}.\]</span> Now, if we form a partition, say <span class="math inline">\(A,A_2,A_3,\dots\)</span>, then we can rewrite <span class="math inline">\(P(B)\)</span> using the law of total probability as <span class="math display">\[P(B) = P(B|A)P(A) + P(B|A_2)P(A_2) + \cdots = P(B|A)P(A) + \sum_{i=2}P(B|A_i)P(A_i).\]</span> Taken together this gives a result known as Bayes’ Theorem.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bayes’ Theorem
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose that there are two events, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, with <span class="math inline">\(P(B) &gt; 0\)</span>. Moreover, suppose that <span class="math inline">\(A\)</span> taken with <span class="math inline">\(A_2, A_3, \dots\)</span> forms a partition. Then Bayes’ Theorem states that <span class="math display">\[P(A|B) = \dfrac{P(B|A)P(A)}{P(B)} = \dfrac{P(B|A)P(A)}{P(B|A)P(A) + \sum_{i=2} P(B|A_i)P(A_i)}.\]</span></p>
</div>
</div>
<p>Bayes’ Theorem allows us to convert statements regarding <span class="math inline">\(P(B|A)\)</span> into statements regarding <span class="math inline">\(P(A|B)\)</span>. Note that, as we derived above, Bayes’ Theorem is an application of the multiplication rule and an application of the law of total probability.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Sometimes we may have <span class="math inline">\(P(B)\)</span> directly, rendering the law of total probability in the denominator unnecessary.</p>
<p>Often, the natural partition to select when we do need the law of total probability is to take <span class="math inline">\(A\)</span> and <span class="math inline">\(A^C\)</span>. Note that any set with its complement forms a partition, since by definition they occupy the entire space and are non-overlapping. When this is done we get the slightly more compact relationship of <span class="math display">\[P(A|B) = \dfrac{P(B|A)P(A)}{P(B|A)P(A) + P(B|A^C)P(A^C)}.\]</span></p>
<p>Bayes’ Theorem differs from our previous relationships as it allows us to translate one set of conditional probabilities into another. Every other relationship we have looked at has moved between types of probabilities, whereas Bayes’ Theorem deals directly with conditional relationships.</p>
<p>A commonly used example application for Bayes’ Theorem is medical testing. Suppose that we know the performance characteristics of a particular medical test: it is <span class="math inline">\(99\%\)</span> accurate for positive cases, and <span class="math inline">\(95\%\)</span> accurate for negative cases. That is, with probability <span class="math inline">\(0.99\)</span> it correctly returns positive when an individual is infected, and with probability <span class="math inline">\(0.95\)</span> it returns negative when an individual is not infected. These are both statements of conditional probability.</p>
<p>If we take <span class="math inline">\(A\)</span> to be the event that the test returns positive, and <span class="math inline">\(B\)</span> to be the event that the patient is infected,<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> then we are saying that <span class="math inline">\(P(A|B) = 0.99\)</span> and <span class="math inline">\(P(A^C|B^C) = 0.95\)</span> which means that <span class="math inline">\(P(A|B^C) = 0.05\)</span>.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> Suppose that we know that, across the entire population, one in a thousand individuals is likely to be infected. This means that <span class="math inline">\(P(B) = 0.001\)</span>.</p>
<p>Now if a random individual goes into a doctor’s office and tests positive for the disease, how likely are they to actually be infected? In this case we want to know the probability of them being infected given that they have tested positive. In notation, this is <span class="math inline">\(P(B|A)\)</span>. We do not know this quantity directly, but given an application of Bayes’ Theorem, we can find it. Using the natural partition of <span class="math inline">\(B\)</span> and <span class="math inline">\(B^C\)</span>, we get <span class="math display">\[P(B|A) = \dfrac{P(A|B)P(A)}{P(A|B)P(B)+P(A|B^C)P(B^C)} = \dfrac{(0.99)(0.001)}{(0.99)(0.001)+(0.05)(0.999)} \approx 0.019.\]</span> That is, despite the fact that this test is exceptionally effective at detecting this disease, a positive test still means that an individual has a probability of only <span class="math inline">\(0.019\)</span> of actually having the illness.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div id="exm-bayes-theorem" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.8 (Sadie’s Late Package)</strong></span> Sadie eventually received the package that Charles had sent, but it arrived very late. Sadie was not home when the package was delivered and there no obvious markings on the box to indicate which of the two delivery companies had sent it.</p>
<p>Given this information, and knowing that company <span class="math inline">\(A\)</span> is late <span class="math inline">\(75\%\)</span> of the time while company <span class="math inline">\(B\)</span> is late <span class="math inline">\(15\%\)</span> of the time, and the store that Charles ordered from sends out <span class="math inline">\(10\%\)</span> of packages with company <span class="math inline">\(A\)</span>, and the rest with company <span class="math inline">\(B\)</span>, what is the probability that the package was delivered by each of the two companies?</p>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We want to determine <span class="math inline">\(P(A|L)\)</span> and <span class="math inline">\(P(B|L)\)</span>. We know that <span class="math inline">\(P(L|A) = 0.75\)</span> and <span class="math inline">\(P(L|B) = 0.15\)</span>. Moreover, we know that <span class="math inline">\(P(A) = 0.1\)</span> and <span class="math inline">\(P(B) = 0.9\)</span>. Applying Bayes’ Theorem directly we get <span class="math display">\[P(A|L) = \dfrac{P(L|A)P(A)}{P(L|A)P(A) + P(L|B)P(B)} = \dfrac{(0.75)(0.10)}{(0.75)(0.10) + (.10)(0.90)} = \dfrac{5}{11}.\]</span> Similarly, we get <span class="math display">\[P(B|L) = \dfrac{P(B|A)P(B)}{P(L|A)P(A) + P(L|B)P(B)} = \dfrac{(0.15)(0.90)}{(0.75)(0.10) + (.10)(0.90)} = \dfrac{6}{11}.\]</span> Note, we could have also used the fact that <span class="math inline">\(P(A|L) + P(B|L) = 1\)</span> to determine this. As a result, it is more likely that <span class="math inline">\(B\)</span> delivered the package than <span class="math inline">\(A\)</span>.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
</div>
</div>
</div>
</div>
<p>Bayes’ Theorem highlights a key lesson when considering conditional probabilities, and it’s a common mistake to make which should be avoided at all costs. Namely, we cannot interchange <span class="math inline">\(P(A|B)\)</span> with <span class="math inline">\(P(B|A)\)</span>. These probabilities are not necessarily highly correlated with one another, and it is important to distinguish clearly which is the probability of interest.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> The stakes of these types of confusion can be quite high, and it is tremendously important to ensure that you are conditioning on the correct events. Fortunately, Bayes’ Theorem allows us to translate between events for conditioning, giving a mechanism from translating between the two.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
</section>
</section>
<section id="independence" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="independence"><span class="header-section-number">4.4</span> Independence</h2>
<p>We have seen that, in most cases, conditioning on an event changes the probability of that event. For instance, if we want to know the probability it is raining, if we condition on knowing that it is a day full of gray skies, the conditional probability is likely higher than the marginal probability. By considering how the marginal and conditional probabilities differ, we are in effect indicating a dependence of the events on one another. In terms of probability, this dependence is captured by an influence on the degree of uncertainty present depending on what we know.</p>
<p>It is totally possible that two events do not influence one another at all. The weather outside today is likely not influenced by your favourite sports team’s performance last night.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> In this case, we would have <span class="math inline">\(P(A|B) = P(A)\)</span>.</p>
<p>We saw an example of this previously when we wanted to know the probability of a randomly selected card being a heart (<span class="math inline">\(A\)</span>) given that it was an ace (<span class="math inline">\(B\)</span>). We found that this was <span class="math inline">\(\dfrac{1}{4}\)</span>, exactly the same as the probability if we did not know that it was an ace. Thus here we have <span class="math inline">\(P(A|B)=P(A)\)</span>. We could have also said that <span class="math inline">\(P(B|A)=P(B)=\dfrac{1}{13}\)</span>. The symmetry of these events makes it somewhat more convenient to express this relationship differently.</p>
<p>Instead of writing <span class="math inline">\(P(A|B) = P(A)\)</span> and <span class="math inline">\(P(B|A) = P(B)\)</span>, we can multiply the first relationship by <span class="math inline">\(P(B)\)</span> on both sides, or the second by <span class="math inline">\(P(A)\)</span> on both sides. The multiplication rule gives <span class="math inline">\(P(A|B)P(B) = P(A,B)\)</span>, and so the first relationship becomes <span class="math inline">\(P(A,B) = P(A)P(B)\)</span>. The second follows exactly the same. Any two events that satisfy this relationship are said to be independent.</p>
<div id="def-independence" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.5 (Independence)</strong></span> Any two events, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, which satisfy <span class="math inline">\(P(A,B) = P(A)P(B)\)</span> are said to be independent. If <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent we write <span class="math inline">\(A\perp B\)</span>, and read “<span class="math inline">\(A\)</span> is independent of <span class="math inline">\(B\)</span>”. Any events which are not independent are said to be dependent, and we write <span class="math inline">\(A\not\perp B\)</span>.</p>
</div>
<p>Note that independence is always a symmetric property: if <span class="math inline">\(A\)</span> is independent of <span class="math inline">\(B\)</span>, then <span class="math inline">\(B\)</span> is independent of <span class="math inline">\(A\)</span>. To check whether two events are independent, we check whether their joint probability is equal to the product of their marginal probabilities.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Properties of Independence
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Note that if <span class="math inline">\(A\perp B\)</span>, then <span class="math inline">\(A^C\perp B\)</span>, <span class="math inline">\(A^C\perp B^C\)</span>, and vice versa. To see this note <span class="math display">\[P(A^C, B) + P(A, B) = P(B),\]</span> by the Law of Total Probability. Then, by independence of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> this gives <span class="math display">\[\begin{align*}
P(A^C, B) + P(A)P(B) &amp;= P(B) \\
\implies P(A^C, B) &amp;= P(B) - P(A)P(B) \\
&amp;= P(B)(1 - P(A)) \\
&amp;= P(B)P(A^C),\end{align*}\]</span> as is required. The other combinations follow in the same manner.</p>
</div>
</div>
</div>
<p>If <span class="math inline">\(P(A)\neq 0\)</span>, then we can divide both sides by <span class="math inline">\(P(A)\)</span> to gives <span class="math inline">\(P(B|A) = P(B)\)</span>. Similarly, if <span class="math inline">\(P(B)\neq 0\)</span>, then we can divide both sides by <span class="math inline">\(P(B)\)</span> to give <span class="math inline">\(P(A|B)=P(A)\)</span>. This expression in terms of conditional probabilities is the more intuitive expression of independence. It directly captures the idea that “knowing <span class="math inline">\(B\)</span> does not change our belief about <span class="math inline">\(A\)</span>”. However, we must be careful. This conditional argument is only valid when the event that is being conditioned on is not probability <span class="math inline">\(0\)</span>, where the defining relationship, <span class="math inline">\(P(A,B) = P(A)P(B)\)</span>, will hold for all events. Recall that, in general, <span class="math display">\[P(A\cap B) = P(A)+P(B)-P(A\cup B).\]</span> It is only when assuming independence that this simplifies further.</p>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em> (The Multiplication and Addition Rules of Probability). </span>Often, in elementary probability and statistics courses, the <strong>Multiplication Rule</strong> and the <strong>Addition Rule</strong> for calculating probabilities are emphasized and named. It is emphasized that to calculate probabilities, we will often multiply together other probabilities, or else add a sequence of them. These rules often form the backbone of probability computation. At this point, we have now seen both the typical Multiplication Rule and the typical Addition Rule, without drawing specific attention to them as such.</p>
<p>The multiplication rule states that, for independent events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, <span class="math inline">\(P(A\cap B) = P(A)P(B)\)</span>. That is, with independent events if you want to know the probability that they both happen, you multiply together the probabilities. The addition rule states that, for disjoint events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, <span class="math inline">\(P(A \cup B) = P(A) + P(B)\)</span>. That is, with disjoint events if you want to know the probability that either or occurs, you add them together. These can be quite handy tools when correctly applied.</p>
<p>For instance, if we assume that we flip a coin then roll a die, we can say that the probability that you get a heads and an even number must be <span class="math inline">\(\dfrac{1}{2}\times\dfrac{1}{2} = \dfrac{1}{4}\)</span> since <span class="math inline">\(P(\text{Heads}) = \dfrac{1}{2}\)</span> and <span class="math inline">\(P(\text{Even}) = \dfrac{1}{2}\)</span>, and the coin flip must be independent of the die roll. Similarly, suppose that we wish to know what the probability that, when drawing a card from a standard deck of <span class="math inline">\(52\)</span> cards, the result is an Ace, Three, Six, or King. Here we can say that this must be <span class="math inline">\(\dfrac{4}{52} + \dfrac{4}{52} + \dfrac{4}{52} + \dfrac{4}{52} = \dfrac{4}{13}\)</span>. This is because each rank has a <span class="math inline">\(\dfrac{4}{52}\)</span> chance of occurring, and each of these events are disjoint.</p>
<p>So, if the multiplication and addition rules are handy, why do we not discuss them directly in these notes? As pointed out, we did learn both of the rules: the multiplication rule is the defining relationship for independent events, and the addition rule is the axiom of additivity. However, highlighting these as substantially more important than the surrounding topics can lead to deeper struggles with probability calculations. Specifically, these two techniques apply in only very limited situations: if we know that events are independent or we know that events are disjoint. Most of the time, neither assumption is going to hold, and in those settings we need to move past multiplying or adding to critically thinking about the specific quantities. This can lead to deeper confusion in translating these beyond simple examples.</p>
<p>The concern here moves beyond ensuring success in introductory sequences of probability and statistics. Uncritical deference to the multiplication and addition rules can have dire real-world consequences. As one particularly sobering example, <a href="https://en.wikipedia.org/wiki/Sally_Clark" target="_BLANK">Sally Clark</a> was convicted in 1999 of the murder of her two sons, each of whom had died a few weeks following their birth. The defense claimed that the deaths were the results of Sudden Infant Death Syndrome (SIDS). The prosecution presented a statistical analysis from a paediatrician, Roy Meadow, who claimed that the probability of an infant dying of SIDS is approximately <span class="math inline">\(\dfrac{1}{8500}\)</span>. An application of the multiplication rule then tells us that the probability that both of Sally Clark’s sons would die of SIDS is <span class="math display">\[\dfrac{1}{8500}\times\dfrac{1}{8500} = \dfrac{1}{72,250,000}.\]</span> This is very rare, and seemed strong enough evidence to convict Sally Clark. The conviction was later overturned on an appeal, owing to both additional evidence coming to light and a <a href="https://web.archive.org/web/20110824151124/http://www.rss.org.uk/uploadedfiles/documentlibrary/744.pdf" target="_BLANK">critique of the statistical reasoning employed in the case</a> published by the Royal Society of Statistics, but only after Sally Clark had served more than three years of a prison sentence.</p>
<p>The stakes of these types of calculations can be tremendously high, and it is critically important to not rely on simplified rules when working with probabilities and statistics. As individuals armed with the tools of probability and statistics it is imperative that we remain responsible with our application of these techniques; there is an air of authority that is carried by quantitative statements, and when misplaced, the consequences can be dire.</p>
</div>
<div id="exm-assessing-independence" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.9 (Independence and Board Games)</strong></span> Charles and Sadie are invited over by their friend, Garth, to play some board games. Both of them are quite excited by this prospect! Board games feel like the next logical step for the two of them to highlight their love of both probability and games! Garth has a large board game collection, and begins to explain the games to Charles and Sadie across a variety of axes:</p>
<ul>
<li>Whether the games are competitive or cooperative.</li>
<li>How many players the games play best at (<span class="math inline">\(\{1, 2, 3, 4+\}\)</span>).</li>
<li>How “heavy” the games tend to be (friendly for everyone, moderately involved, or very heavy).</li>
</ul>
<p>While Garth continues on about several other topics including the themes, the mechanics, or the rating on BoardGameGeek, Charles drifts off wondering whether the traits listed are independent in Garth’s collection. Suppose that Garth has <span class="math inline">\(100\)</span> games, of which:</p>
<ul>
<li><span class="math inline">\(25\)</span> are cooperative.</li>
<li><span class="math inline">\(5\)</span> are best played at one player, <span class="math inline">\(20\)</span> at two, and <span class="math inline">\(55\)</span> at three.</li>
<li><span class="math inline">\(10\)</span> are friendly for everyone and <span class="math inline">\(45\)</span> are moderately involved.</li>
</ul>
<ol type="a">
<li>If <span class="math inline">\(5\)</span> games are best played at two players and are cooperative, are these events independent?</li>
<li>If <span class="math inline">\(20\)</span> games are heavy and best played with <span class="math inline">\(4+\)</span> players, are these events independent?</li>
<li>If <span class="math inline">\(0\)</span> games are both moderately involved and cooperative, are these events independent?</li>
<li>Charles figures that competitive games and two player games are independent. How many competitive two player games are there?</li>
<li>Is it possible that competitive games are independent of heavy games?</li>
</ol>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>We are suggesting that <span class="math inline">\(P(A,B) = 0.05\)</span>, where <span class="math inline">\(A\)</span> is “two player” and <span class="math inline">\(B\)</span> is “cooperative”. We know that <span class="math inline">\(P(B) = 0.25\)</span> and <span class="math inline">\(P(A) = 0.20\)</span>. Calculating <span class="math inline">\(P(A)P(B) = (0.20)(0.25) = 0.05 = P(A,B)\)</span>, and so these traits <strong>are</strong> independent.</p></li>
<li><p>We have <span class="math inline">\(P(A,B) = 0.2\)</span> where <span class="math inline">\(A\)</span> is “heavy” and <span class="math inline">\(B\)</span> is “<span class="math inline">\(4+\)</span> players. We know that <span class="math inline">\(P(A) = 0.45\)</span> and <span class="math inline">\(P(B) = 0.20\)</span>, and so <span class="math inline">\(P(A)P(B) = (0.45)(0.20) = 0.09 \neq P(A,B)\)</span>. As a result, these traits are <strong>not</strong> independent.</p></li>
<li><p>We know that <span class="math inline">\(P(A) &gt; 0\)</span> and <span class="math inline">\(P(B) &gt; 0\)</span> for <span class="math inline">\(A\)</span> being moderately involved and <span class="math inline">\(B\)</span> being cooperative. As a result, <span class="math inline">\(P(A)P(B) &gt; 0\)</span>, and so if <span class="math inline">\(P(A,B) = 0\)</span>, they must <strong>not</strong> be independent.</p></li>
<li><p>Taking <span class="math inline">\(A\)</span> to be “competitive” we have <span class="math inline">\(P(A) = 0.75\)</span>. Taking <span class="math inline">\(B\)</span> to be “two player” we have <span class="math inline">\(P(B) = 0.20\)</span>. As a result, if <span class="math inline">\(A\perp B\)</span> then <span class="math inline">\(P(A,B) = P(A)P(B) = (0.75)(0.20) = 0.15\)</span>. Thus, there must be <span class="math inline">\(15\)</span> competitive, two player games.</p></li>
<li><p>Taking <span class="math inline">\(A\)</span> to be “competitive” we have <span class="math inline">\(P(A) = 0.75\)</span>. Taking <span class="math inline">\(B\)</span> to be “heavy” weh ave <span class="math inline">\(P(B) = 0.45\)</span>. Thus, if they were independent, we would have <span class="math inline">\(P(A,B) = P(A)P(B) = (0.75)(0.45) = 0.3375\)</span>. This would require <span class="math inline">\(33.75\)</span> games to be heavy, competitive games and so we must conclude that they are <strong>not</strong> independent.</p></li>
</ol>
</div>
</div>
</div>
</div>
<section id="mutually-exclusive-events" class="level4" data-number="4.4.0.1">
<h4 data-number="4.4.0.1" class="anchored" data-anchor-id="mutually-exclusive-events"><span class="header-section-number">4.4.0.1</span> Mutually Exclusive Events</h4>
<p>Importantly, if <span class="math inline">\(A\perp B\)</span>, then <span class="math inline">\(A\cap B\neq \emptyset\)</span> unless at least one of <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span> equals <span class="math inline">\(\emptyset\)</span> or <span class="math inline">\(\mathcal{S}\)</span>. To see this recall that <span class="math inline">\(P(\emptyset) = 0\)</span>, and so if <span class="math inline">\(A\cap B = \emptyset\)</span> then <span class="math inline">\(P(A\cap B) = P(A)P(B) = P(\emptyset) = 0\)</span>. Moreover, <span class="math inline">\(P(\mathcal{S}) = 1\)</span> and <span class="math inline">\(\mathcal{S} \cap B = B\)</span>, so <span class="math inline">\(P(\mathcal{S} \cap B) = 1P(B) = P(B)\)</span>. This only holds if either probability is <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. This may seem to be a rather technical point, however, it is the source of much confusion regarding independence. In particular, it is common to mistake independent events for mutually exclusive events.</p>
<div id="def-mutually-exclusive-events" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.6 (Mutually Exclusive Events)</strong></span> Two events, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are said to be mutually exclusive if they are disjoint. In particular, if <span class="math inline">\(P(A,B) = 0\)</span> then <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are mutually exclusive. If <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are mutually exclusive events, with <span class="math inline">\(P(A) &gt; 0\)</span> and <span class="math inline">\(P(B) &gt; 0\)</span>, then <span class="math inline">\(A\not\perp B\)</span>.</p>
</div>
<p>Whenever only one event from a set of events can happen, we refer to the events as being mutually exclusive. If one happens, we know that the others did not. Mutually exclusive events, with positive probability, are always dependent since knowing that <span class="math inline">\(A\)</span> occurs dramatically shifts our belief about <span class="math inline">\(B\)</span>,<span class="math inline">\(C\)</span>, and <span class="math inline">\(D\)</span>.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<p>The primary concern with mutually exclusive and independent events is a linguistic one. We often use words like independent to mean unrelated, and in a sense, mutually exclusive events are unrelated in that one has nothing to do with another. However, in statistics and probability, when we discuss independence, it is not an independence of the events themselves but rather an independence relating to our beliefs regarding the uncertainty associated with the events. In this sense, mutually exclusive events are very informative regarding the uncertainty associated with them.</p>
<div id="exm-independence-two" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.10 (Charles and Sadie Cooking Dinner)</strong></span> Suppose that Charles and Sadie always eat dinner together. It will either be the case that Charles cooks at home, that Sadie cooks at home, that the two of them order in, or that they go out to eat. If we take these to be four events, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>, and <span class="math inline">\(D\)</span>, then are any of these events independent? Mutually exclusive? Explain.</p>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Assuming, as it seems reasonable given the information in the question, that only one of the possible tasks occurs for dinner in a night, then we <em>know</em> that <span class="math display">\[P(A,B) = P(A,C) = P(A,D) = P(B,C) = P(B,D) = P(C,D) = 0.\]</span> As a result, all of the events described are mutually exclusive, and correspondingly, are <em>not</em> independent.</p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-contingency-tables" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-contingency-tables"><span class="header-section-number">4.5</span> Contingency Tables</h2>
<p>Through to this point we have discussed probabilities in the abstract, either through an enumeration of equally likely outcomes, or else by directly specifying the likelihood of various events. While these are useful in many regards, we are often looking for more concise manners of summarizing information of interest. One tool for accomplishing this is a contingency table.</p>
<div id="def-contingency-table" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.7 (Contingency Table)</strong></span> A contingency table is a tabular summary of information which summarizes the joint probabilities of two or more variables. Typically a contingency table will take one factor for the columns and a secondary factor for the rows, where each cell then represents the frequency with which observations occur in the two corresponding categories simultaneously.</p>
</div>
<p>To begin, you could imagine constructing a frequency table relaying the frequency with which undergraduate students are enrolled in various faculties at a particular university. This tells you, of the whole population of students at the university, what is the faculty breakdown. By dividing the number in each faculty by the total number of students, you convert the frequencies to proportions, and these proportions can be viewed as probabilities. (See <a href="#tbl-uni-frequency" class="quarto-xref">Table&nbsp;<span>4.1</span></a>.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>) The interpretation of proportions as probabilities implies a very specific statistical experiment. In particular, the proportion represents the probability that an individual selected at random from the entire population has the given trait. This is frequently a probability of interest, which makes these summary tables a useful tool.<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
<div class="cell" data-tbl-colwidths="[20,40,40]">
<div id="tbl-uni-frequency" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20,40,40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-uni-frequency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Frequency and corresponding proportions of enrolment by faculty in a university.
</figcaption>
<div aria-describedby="tbl-uni-frequency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Faculty</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Enrolment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Arts</td>
<td style="text-align: right;">1266</td>
<td style="text-align: right;">0.2182382</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Computer Science</td>
<td style="text-align: right;">749</td>
<td style="text-align: right;">0.1291157</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Education</td>
<td style="text-align: right;">786</td>
<td style="text-align: right;">0.1354939</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Engineering</td>
<td style="text-align: right;">1315</td>
<td style="text-align: right;">0.2266851</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Law</td>
<td style="text-align: right;">266</td>
<td style="text-align: right;">0.0458542</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Nursing</td>
<td style="text-align: right;">543</td>
<td style="text-align: right;">0.0936046</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; border-bottom: 1px solid;">Science</td>
<td style="text-align: right; border-bottom: 1px solid;">876</td>
<td style="text-align: right; border-bottom: 1px solid;">0.1510084</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; font-weight: bold;">Total</td>
<td style="text-align: right; font-weight: bold;">5801</td>
<td style="text-align: right; font-weight: bold;">1.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>When a single trait is displayed we refer to these tabular summaries as frequency tables or frequency distributions. A contingency table instead plots two or more traits on the same table, with each cell representing the frequency of both traits occurring simultaneously in the population. Extending the university example, we may further include the student’s current year of study to see the breakdown of both faculty and year of study, in one table.</p>
<div class="cell" data-tbl-colwidths="[20,40,40]">
<div id="tbl-uni-contingency" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20,40,40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-uni-contingency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.2: Frequency of enrolment by faculty and year of study in a university.
</figcaption>
<div aria-describedby="tbl-uni-contingency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 3</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 4</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 5+</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Arts</td>
<td style="text-align: center;">222</td>
<td style="text-align: center;">276</td>
<td style="text-align: center;">273</td>
<td style="text-align: center;">225</td>
<td style="text-align: center;">270</td>
<td style="text-align: center; font-weight: bold;">1266</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Comp. Sci.</td>
<td style="text-align: center;">164</td>
<td style="text-align: center;">87</td>
<td style="text-align: center;">164</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">244</td>
<td style="text-align: center; font-weight: bold;">749</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Education</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">136</td>
<td style="text-align: center;">184</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">238</td>
<td style="text-align: center; font-weight: bold;">786</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Engineering</td>
<td style="text-align: center;">189</td>
<td style="text-align: center;">290</td>
<td style="text-align: center;">354</td>
<td style="text-align: center;">298</td>
<td style="text-align: center;">184</td>
<td style="text-align: center; font-weight: bold;">1315</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Law</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">67</td>
<td style="text-align: center; font-weight: bold;">266</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Nursing</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">154</td>
<td style="text-align: center;">112</td>
<td style="text-align: center;">132</td>
<td style="text-align: center; font-weight: bold;">543</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Science</td>
<td style="text-align: center;">242</td>
<td style="text-align: center;">114</td>
<td style="text-align: center;">206</td>
<td style="text-align: center;">183</td>
<td style="text-align: center;">131</td>
<td style="text-align: center; font-weight: bold;">876</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; font-weight: bold;"></td>
<td style="text-align: center; font-weight: bold;">1026</td>
<td style="text-align: center; font-weight: bold;">1043</td>
<td style="text-align: center; font-weight: bold;">1393</td>
<td style="text-align: center; font-weight: bold;">1073</td>
<td style="text-align: center; font-weight: bold;">1266</td>
<td style="text-align: center; font-weight: bold; font-weight: bold;">5801</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>By including two (or more) factors in the table we are able to capture not only the marginal probabilities for the population, but also the joint probabilities for the population, and in turn, the conditional probabilities for the population. Being able to concisely summarize all of these concepts regarding traits in a population of interest renders contingency tables immensely useful in the study of uncertainty broadly.</p>
<p>Consider the two-way contingency table, <a href="#tbl-uni-contingency" class="quarto-xref">Table&nbsp;<span>4.2</span></a>. Each cell consists of frequency with which a combination of the two traits occurs in the population.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> If we take events corresponding to each of the levels of the two variables of interest, then these central cells represent the frequency of joint events. That is, each interior cell gives the total number of observations with a set level for variable one<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a> AND a set level for variable two<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a>. For instance, there are 50 individuals who are in Law and studying in Year 2.</p>
<p>Each row is then summed, with the total number following into the corresponding row recorded in the right hand margin. each column is summed, with the total number corresponding to the given column recorded in the bottom margin. For instance there are a total of 786 students in Education and a total of 1393 in Year 3. Then the margin totals are summed and the total is recorded in the lower right margin space (in this case, 5801). Whether the rows or columns are summed, they should sum to the same total, which is the total of the population under consideration. This is the same as simply adding all of the observed interior frequencies. To turn a frequency into a probability, you need only divide the correct frequency by the correct total.</p>
<div class="cell" data-tbl-colwidths="[20,40,40]">
<div id="tbl-uni-prop" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20,40,40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-uni-prop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.3: Proportions of enrolment by faculty and year of study in a university.
</figcaption>
<div aria-describedby="tbl-uni-prop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 3</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 4</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year 5+</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Arts</td>
<td style="text-align: center;">0.0382693</td>
<td style="text-align: center;">0.0475780</td>
<td style="text-align: center;">0.0470609</td>
<td style="text-align: center;">0.0387864</td>
<td style="text-align: center;">0.0465437</td>
<td style="text-align: center; font-weight: bold;">0.2182382</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Comp. Sci.</td>
<td style="text-align: center;">0.0282710</td>
<td style="text-align: center;">0.0149974</td>
<td style="text-align: center;">0.0282710</td>
<td style="text-align: center;">0.0155146</td>
<td style="text-align: center;">0.0420617</td>
<td style="text-align: center; font-weight: bold;">0.1291157</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Education</td>
<td style="text-align: center;">0.0172384</td>
<td style="text-align: center;">0.0234442</td>
<td style="text-align: center;">0.0317187</td>
<td style="text-align: center;">0.0220652</td>
<td style="text-align: center;">0.0410274</td>
<td style="text-align: center; font-weight: bold;">0.1354939</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Engineering</td>
<td style="text-align: center;">0.0325806</td>
<td style="text-align: center;">0.0499914</td>
<td style="text-align: center;">0.0610240</td>
<td style="text-align: center;">0.0513705</td>
<td style="text-align: center;">0.0317187</td>
<td style="text-align: center; font-weight: bold;">0.2266851</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Law</td>
<td style="text-align: center;">0.0093087</td>
<td style="text-align: center;">0.0086192</td>
<td style="text-align: center;">0.0099983</td>
<td style="text-align: center;">0.0063782</td>
<td style="text-align: center;">0.0115497</td>
<td style="text-align: center; font-weight: bold;">0.0458542</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Nursing</td>
<td style="text-align: center;">0.0094811</td>
<td style="text-align: center;">0.0155146</td>
<td style="text-align: center;">0.0265471</td>
<td style="text-align: center;">0.0193070</td>
<td style="text-align: center;">0.0227547</td>
<td style="text-align: center; font-weight: bold;">0.0936046</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Science</td>
<td style="text-align: center;">0.0417169</td>
<td style="text-align: center;">0.0196518</td>
<td style="text-align: center;">0.0355111</td>
<td style="text-align: center;">0.0315463</td>
<td style="text-align: center;">0.0225823</td>
<td style="text-align: center; font-weight: bold;">0.1510084</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; font-weight: bold;"></td>
<td style="text-align: center; font-weight: bold;">0.1768661</td>
<td style="text-align: center; font-weight: bold;">0.1797966</td>
<td style="text-align: center; font-weight: bold;">0.2401310</td>
<td style="text-align: center; font-weight: bold;">0.1849681</td>
<td style="text-align: center; font-weight: bold;">0.2182382</td>
<td style="text-align: center; font-weight: bold; font-weight: bold;">1.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>For the standard joint probabilities, you take the interior cell count and divide by the population total. Here we are saying that some fixed number, <span class="math inline">\(m\)</span>, of the <span class="math inline">\(N\)</span> total individuals have both traits under consideration. For instance, the joint probability that a student is in Law and studying in Year 2 is 0.0086192.<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a> If instead you wish to find a marginal probability, you have to consider the value in the corresponding margin: this is the total number of individuals with the given trait, ignoring the level of the other variable. These marginal values are also divided by the total population size. For instance, there is a 0.1354939 probability of observing a student in Education and a probability 0.240131 of observing a student in Year 3.</p>
<p>Outside of joint and marginal probabilities, we can also find conditional probabilities. To do so, we restrict our focus to either only one row, or one column. Then, we can take the joint cell and divide by the value in the margin, which gives the conditional probability of interest. Note, this works with <em>either</em> the contingency table directly <strong>or</strong> with the propensity table. The reasoning is that the propensity table divided by the same totals in the numerator and the denominator. Suppose we take some cell, <span class="math inline">\(A\cap B\)</span>, which has <span class="math inline">\(N_{A, B}\)</span> in the contingency table. Then, <span class="math display">\[P(A\cap B) = \dfrac{N_{A, B}}{N} \quad\quad\text{and}\quad\quad P(B) = \dfrac{N_B}{N}.\]</span> If we consider then forming <span class="math inline">\(P(A|B)\)</span> we get <span class="math display">\[P(A|B) = \dfrac{P(A \cap B)}{P(B)} = \dfrac{N_{A \cap B}/\cancel{N}}{N_B/\cancel{N}} = \dfrac{N_{A, B}}{N_B}.\]</span> Thus, given that we know a student is in Education, then the probability that they are in Year 3 is approximately 0.2341.</p>
<p>Note that these procedures are exactly in line with what we had seen before. The conditional probability is defined as the joint probability divided by the marginal probability. The process of computing the marginal can be seen as an application of the law of total probability. As a result, contingency tables can be a useful, tangible tool for investigating the techniques we have been discussing: they are not a substitute for direct manipulation of the mathematical objects, but they can present insight into the underlying processes where it may be hard to derive that insight otherwise.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Law of Total Probability: Contingency Table’s Version
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Recall that the law of total probability states that, if <span class="math inline">\(B_1,\dots,B_n\)</span> forms a partition of the sample space, then <span class="math display">\[P(A) = \sum_{i=1}^n P(A|B_i)P(B_i) = \sum_{i=1}^n P(A, B_i)\]</span>. In a contingency table it is easier to see how either of the two factors at play (either those in the rows or the columns) forms a partition of the space. Every observation has to fall in exactly one row and exactly one column. Thus, if we want to know the marginal frequency of a single trait (say represented by some row of the table), then one way to find this total is to sum up every observation in each of the corresponding columns. This is <em>precisely</em> the same process as the law of total probability. Note that, denoting each column as <span class="math inline">\(B_i\)</span>, and supposing there are <span class="math inline">\(k\)</span> total columns, then the total number in a row is taken to be <span class="math display">\[N_A = \sum_{i=1}^k N_{A, B_i},\]</span> simply as the summation of the corresponding row. By definition, <span class="math inline">\(P(A) = \dfrac{N_A}{N}\)</span>, and so dividing both sides by <span class="math inline">\(N\)</span> gives <span class="math display">\[P(A) = \dfrac{N_A}{N} = \dfrac{1}{N}\sum_{i=1}^k N_{A, B_i} = \sum_{i=1}^k \dfrac{N_{A, B_i}}{N} = \sum_{i=1}^n P(A\cap B_i).\]</span></p>
</div>
</div>
</div>
<p>It is important to note that there is redundant information within a contingency table. For instance, the margins need not be listed explicitly, as they can be directly calculated from the interior points. Same goes for interior points, given the margins of the table (assuming <em>some</em> interior points are also presented). This can be useful for a compact representation of the information, and manipulating these tables – being able to find the required information in many places – should become familiar to you as you continue to work with them more and more.</p>
<div id="exm-charles-contingency-table" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.11 (The Evolving Contents of Charle’s Urns)</strong></span> After learning of contingency tables, Sadie points out to Charles that with the whole urn debacle they went through, the two of them actually ended up using a contingency table to summarize the information. How neat! In the interim, there has been some development in the contents of Charles’s urns, and armed with the new knowledge of contingency tables, the following summary is produced.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Cone</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Cube</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Pyramid</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Sphere</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Black</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center; font-weight: bold;">10</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Blue</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center; font-weight: bold;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Green</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">5</td>
<td style="text-align: center; font-weight: bold;">15</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Red</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center; font-weight: bold;">D</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Yellow</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center; font-weight: bold;">13</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; font-weight: bold;"></td>
<td style="text-align: center; font-weight: bold;">13</td>
<td style="text-align: center; font-weight: bold;">E</td>
<td style="text-align: center; font-weight: bold;">13</td>
<td style="text-align: center; font-weight: bold;">12</td>
<td style="text-align: center; font-weight: bold; font-weight: bold;">50</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Sadly, Charles does not have the best writing and Sadie cannot make out what values were written in for the cells marked <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(D\)</span>, and <span class="math inline">\(E\)</span>.</p>
<ol type="a">
<li>What are the values for the missing values?</li>
<li>What is the probability that a black cube is drawn?</li>
<li>What is the probability that a red object is drawn?</li>
<li>What is the probability that a cube is drawn?</li>
<li>Given that the drawn object was a pyramid, what is the probability that it is green?</li>
<li>Given that the object is green, what is the probability that it is a pyramid.</li>
</ol>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>We start by filling in the missing cells, in order.</p>
<ol type="i">
<li><p>For <span class="math inline">\(A\)</span> we can note that <span class="math inline">\(2 + A + 1 + 3 = 10\)</span>, which gives that <span class="math inline">\(A = 4\)</span>. We could have also tried a column sum, however, this would involve <span class="math inline">\(3\)</span> unknowns and so would not have given a numeric result.</p></li>
<li><p>For <span class="math inline">\(B\)</span> either a row sum or column sum would produce the correct answer. We either take <span class="math inline">\(3 + 3 + B + 5 = 15\)</span> giving <span class="math inline">\(B = 4\)</span> or <span class="math inline">\(1 + 1 + B + 3 + 4 = 13\)</span> giving <span class="math inline">\(B=4\)</span>.</p></li>
<li><p><span class="math inline">\(C\)</span> is more challenging as we either have that <span class="math inline">\(2 + C + 3 + 2 = D\)</span> or <span class="math inline">\(4 + 2 + 3 + C + 3 = E\)</span><a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a> As a result, for this technique we will need to find either <span class="math inline">\(D\)</span> or <span class="math inline">\(E\)</span> first. There is an alternative technique to use, which would be to note that we have <em>all</em> the internal points specified at this point, and we know that these sum to <span class="math inline">\(50\)</span>. As a result, we could note that <span class="math inline">\(C = 50 - 10 - 5 - 15 - 13 - 2 - 3 - 2 = 0\)</span> or that <span class="math inline">\(C =  50 - 13 - 13 - 12 - 4 - 2 - 3 - 3 = 0\)</span>.</p></li>
<li><p>We can find <span class="math inline">\(D\)</span> either by subtracting from the total, <span class="math inline">\(D = 50 - 10 - 5 - 15 - 13 = 7\)</span>, or by adding along the row, <span class="math inline">\(2 + 0 + 3 + 2 = 7\)</span>.<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a> Note that with <span class="math inline">\(D = 7\)</span>, had we not found <span class="math inline">\(C = 0\)</span> above, we could now take <span class="math inline">\(2 + C + 3 + 2 = 7\)</span> and find <span class="math inline">\(C = 0\)</span>.</p></li>
<li><p>Like <span class="math inline">\(D\)</span>, we have two options for working this out. Either <span class="math inline">\(E = 50 - 13 - 13 - 12 = 12\)</span> or <span class="math inline">\(E = 4 + 2 + 3 + 0 + 3 = 12\)</span>.<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a> Like with <span class="math inline">\(D\)</span>, had we solved for <span class="math inline">\(E\)</span> first, then we could find <span class="math inline">\(C\)</span> via <span class="math inline">\(4 + 2 + 3 + C + 3 = 12\)</span>.</p></li>
</ol></li>
<li><p>Here we want <span class="math inline">\(P(\text{Black}, \text{Cube})\)</span>. This is given by the frequency of black cubes divided by <span class="math inline">\(50\)</span>. Thus, <span class="math display">\[P(\text{Black}, \text{Cube}) = \dfrac{A}{50} = \dfrac{4}{50} = 0.08.\]</span></p></li>
<li><p>Here we want <span class="math inline">\(P(\text{Red})\)</span>. This is given by the marginal frequency of red objects divided by <span class="math inline">\(50\)</span>. Thus, <span class="math display">\[P(\text{Red}) = \dfrac{D}{50} = \dfrac{7}{50} = 0.14.\]</span></p></li>
<li><p>Here we want <span class="math inline">\(P(\text{Cube})\)</span>. This is given by the marginal frequency of cubes divided by <span class="math inline">\(50\)</span>. Thus, <span class="math display">\[P(\text{Cube}) = \dfrac{E}{50} = \dfrac{12}{50} = 0.24.\]</span></p></li>
<li><p>Here we want <span class="math inline">\(P(\text{Green}|\text{Pyramid})\)</span>. This is given by the frequency of green pyramids divided by the marginal frequency of pyramids. Thus <span class="math display">\[P(\text{Green}|\text{Pyramid}) = \dfrac{B}{13} = \dfrac{4}{13} \approx 0.308.\]</span></p></li>
<li><p>Here we want <span class="math inline">\(P(\text{Pyramid}|\text{Green})\)</span>. This is given by the frequency of green pyramids divided by the marginal frequency of green objects.<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a> Thus <span class="math display">\[P(\text{Pyramid}|\text{Green}) = \dfrac{B}{15} = \dfrac{4}{15} \approx 0.267.\]</span></p></li>
</ol>
</div>
</div>
</div>
</div>
<p>It is also important to recognize that independence and mutually exclusive events can be codified via the table as well. Zeros on the interior points indicate events which are mutually exclusive: if we know that one of them occurred, we also know that the other one did not. For independence, it requires a degree of solving proportions. We can either check that the joint probability (<span class="math inline">\(N_{A,B}/N\)</span>) is equal to the product of the two marginal probabilities, (<span class="math inline">\(N_AN_B/N^2\)</span>), or else (assuming that the events are all non-zero), that the conditional probability (<span class="math inline">\(N_{A,B}/N_A\)</span>) equals the marginal probability <span class="math inline">\(N_B/N\)</span>. Either way this is represented by <span class="math inline">\(N\times N_{A,B} = N_AN_B\)</span>, and when this holds, we can conclude that the events are independent.</p>
<div id="exm-contingency-table-mututally-exclusive" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.12 (Independent or Mutually Exclusive Urn Shapes)</strong></span> After helping Charles <em>neatly</em> fill in the contingency table, Sadie begins to wonder about whether there are any shape-colour combinations which are independent, or if any are mutually exclusive.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Cone</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Cube</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Pyramid</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Sphere</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Black</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center; font-weight: bold;">10</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Blue</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center; font-weight: bold;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Green</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5</td>
<td style="text-align: center; font-weight: bold;">15</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Red</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center; font-weight: bold;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Yellow</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center; font-weight: bold;">13</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; font-weight: bold;"></td>
<td style="text-align: center; font-weight: bold;">13</td>
<td style="text-align: center; font-weight: bold;">12</td>
<td style="text-align: center; font-weight: bold;">13</td>
<td style="text-align: center; font-weight: bold;">12</td>
<td style="text-align: center; font-weight: bold; font-weight: bold;">50</td>
</tr>
</tbody>
</table>


</div>
</div>
<ol type="a">
<li>Are there any events represented in the contingency table which are mutually exclusive?</li>
<li>Are there any events represented in the contingency table which are independent?</li>
</ol>
<div class="solution callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>Mutually exclusive events are codified via a <span class="math inline">\(0\)</span> frequency. We can see then that <span class="math inline">\(\text{Cube}\)</span> and <span class="math inline">\(\text{Red}\)</span> are mutually exclusive. That is, if we know that an object is red, we also know that it is not a cube. And if we know that an object is a cube, then we know that it is not red.</p></li>
<li><p>Independence is more cumbersome to check. We require the product of marginal counts to be equal to the total times by the joint counts. As a result, the easiest way to check is to consider the product of each marginal value in the columns by each marginal value in the row, divided by <span class="math inline">\(50\)</span>. If this value corresponds to the value in that row/column pairing, then we know that those features are independent. Note that immediately we can rule out any products which are not divisible by <span class="math inline">\(50\)</span>, since we know that <span class="math inline">\(N_{A,B}\)</span> is an integer for all <span class="math inline">\(A,B\)</span> and <span class="math inline">\(N_{A,B} = N_AN_B/50\)</span> if there is independence. To this end, we only need to check the product of each of the row totals with each of <span class="math inline">\(12\)</span> and <span class="math inline">\(13\)</span> (as those are the only two unique column totals). This gives, in order <span class="math inline">\(120\)</span>, <span class="math inline">\(130\)</span>, <span class="math inline">\(60\)</span>, <span class="math inline">\(65\)</span>, <span class="math inline">\(180\)</span>, <span class="math inline">\(195\)</span>, <span class="math inline">\(84\)</span>, <span class="math inline">\(91\)</span>, <span class="math inline">\(156\)</span>, and <span class="math inline">\(169\)</span>. None of these values are divisible by <span class="math inline">\(50\)</span> and as a result we know that there is <strong>no independence</strong> codified in this table.</p></li>
</ol>
</div>
</div>
</div>
</div>
<section id="contingency-tables-and-data-frames-in-r" class="level4" data-number="4.5.0.1">
<h4 data-number="4.5.0.1" class="anchored" data-anchor-id="contingency-tables-and-data-frames-in-r"><span class="header-section-number">4.5.0.1</span> Contingency Tables and Data Frames in R</h4>
<p>In R we can use the <code>table</code> and <code>prop.table</code> to calculate the (interior) of a contingency table. This will return a <code>table</code> type object in R, which can be thought of as a matrix of sorts. On it, we can use the functions <code>rowSums</code> and <code>colSums</code> to get the summation of the rows and columns, respectively. Typically the object we pass to <code>table</code> will be a <strong>data frame</strong>. A data frame is another R object type that we have not yet seen. The idea with a data frame is that we have multiple columns with different variables (of possibly different types) represented. Each row corresponds to a single observation, and then each column is read as a feature of those observations. Data frames are essentially large spreadsheets (or data tables) which indicate the various observations that we have. In practice, data frames are the most commonly used object in an R analysis, and we will see them plenty going forward.</p>
<div id="qwebr-insertion-location-1"></div>
<script type="module">
// Retrieve the insertion point
const currentDocumentLocation = document.getElementById("qwebr-insertion-location-1");

// Initalize an interactive element
const initializedElement =   qwebrCreateInteractiveElement(
    1
  );

// Add the interactive element into the document scope
currentDocumentLocation.appendChild(initializedElement);

// Initialize a Monaco Editor Instance
qwebrCreateMonacoEditorInstance(
  `# As always, when randomization is to be used, we call
# the set.seed function to ensure that the analysis can be
# replicated.
set.seed(314)

# Begin by Defining the possible shapes and colours for
# the objects in Charles's urns
shapes <- c("Sphere", "Cube", "Pyramid", "Cone")
colours <- c("Red", "Blue", "Green", "Yellow", "Black")

# Use sample to draw 50 different shapes, and 50 different
# colours. We are drawing *with* replacement.
all_shapes <- sample(x = shapes, size = 50, replace = TRUE)
all_colours <- sample(x = colours, size = 50, replace = TRUE)

# Now we form the data frame. This will consist of two columns,
# one called "Colours" and one called "Shapes". The values to 
# place here will correspond to the random colours and shapes we
# sampled above.
charles_data <- data.frame("Colours" = all_colours, "Shapes" = all_shapes)

# To get a sense of the data frame we can use the head function
# which will return the first few rows of our data frame.
head(charles_data)`, 
  1);
</script>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
<p>With a data frame specified, we can then use the <code>table</code> function called on it to form a contingency table.</p>
<div id="qwebr-insertion-location-2"></div>
<script type="module">
// Retrieve the insertion point
const currentDocumentLocation = document.getElementById("qwebr-insertion-location-2");

// Initalize an interactive element
const initializedElement =   qwebrCreateInteractiveElement(
    2
  );

// Add the interactive element into the document scope
currentDocumentLocation.appendChild(initializedElement);

// Initialize a Monaco Editor Instance
qwebrCreateMonacoEditorInstance(
  `charles_c_table <- table(charles_data)

charles_c_table`, 
  2);
</script>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
<p>Then, to get the totals, we can either use <code>rowSums</code> or <code>colSums</code> to return a vector with the corresponding row or column sums.</p>
<div id="qwebr-insertion-location-3"></div>
<script type="module">
// Retrieve the insertion point
const currentDocumentLocation = document.getElementById("qwebr-insertion-location-3");

// Initalize an interactive element
const initializedElement =   qwebrCreateInteractiveElement(
    3
  );

// Add the interactive element into the document scope
currentDocumentLocation.appendChild(initializedElement);

// Initialize a Monaco Editor Instance
qwebrCreateMonacoEditorInstance(
  `marginal_shapes <- colSums(charles_c_table)
marginal_colours <- rowSums(charles_c_table)

marginal_shapes
marginal_colours`, 
  3);
</script>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
<p>Finally, we can take our formed contingency table, and use <code>prop.table</code> on it, in order to return a table with the proportions (rather than the frequencies).</p>
<div id="qwebr-insertion-location-4"></div>
<script type="module">
// Retrieve the insertion point
const currentDocumentLocation = document.getElementById("qwebr-insertion-location-4");

// Initalize an interactive element
const initializedElement =   qwebrCreateInteractiveElement(
    4
  );

// Add the interactive element into the document scope
currentDocumentLocation.appendChild(initializedElement);

// Initialize a Monaco Editor Instance
qwebrCreateMonacoEditorInstance(
  `charles_p_table <- prop.table(charles_c_table)

charles_p_table`, 
  4);
</script>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
</section>
</section>
<section id="exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-4.1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1</strong></span> Four cards are dealt, in order, from a standard pack of <span class="math inline">\(52\)</span> cards.</p>
<ol type="a">
<li>What is the probability that all four are spades?</li>
<li>What is the probability that two or fewer are spades?</li>
<li>What is the probability that all four are spades, given that the first two are spades?</li>
<li>What is the probability that spades and hearts alternate?</li>
</ol>
</div>
<div id="exr-4.2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2</strong></span> Two cards are dealt from a deck of <span class="math inline">\(52\)</span> cards. Find the probability that the second card dealt is a heart.</p>
</div>
<div id="exr-4.3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.3</strong></span> A manufacturer of computer chips bins their manufactured chips based on the quality. Their production line ends up producing <span class="math inline">\(1\)</span> high quality chip for every <span class="math inline">\(2\)</span> medium quality chips and <span class="math inline">\(2\)</span> low quality chips. That is, the proportions of high-to-medium-to-low remains <span class="math inline">\(1:2:2\)</span>. For each quality level of chip, the probability that it is of unacceptable standard is <span class="math inline">\(0\)</span>, <span class="math inline">\(0.1\)</span>, and <span class="math inline">\(0.2\)</span> respectively. Suppose a bin of chips is selected at random, two chips are tested, and found to be satisfactory.</p>
<ol type="a">
<li>What is the probability it is a high quality bin?</li>
<li>What is the probability it is a medium quality bin?</li>
<li>What is the probability it is a low quality bin?</li>
</ol>
</div>
<div id="exr-4.4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.4</strong></span> Consider the following argument from <em>Pillow Problems</em> <span class="citation" data-cites="Carroll">Carroll (<a href="#ref-Carroll" role="doc-biblioref">2013</a>)</span>, which purports to prove mathematically that no urn can have two balls of the same colour in it.</p>
<blockquote class="blockquote">
<p>A bag contains 2 counters, as to which nothing is known except that each is either black or white. Ascertain their colours without taking them out of the bag.</p>
<p>We know that, if a bag contained 3 counters, 2 being black and one white, the chance of drawing a black one would be <span class="math inline">\(\dfrac{2}{3}\)</span>; and that any other state of things would not give this chance. Now the chances, that the given bag contains (<span class="math inline">\(\alpha\)</span>) BB, (<span class="math inline">\(\beta\)</span>) BW, (<span class="math inline">\(\gamma\)</span>) WW, are respectively <span class="math inline">\(\dfrac{1}{4}\)</span>, <span class="math inline">\(\dfrac{1}{2}\)</span>, <span class="math inline">\(\dfrac{1}{4}\)</span>.</p>
<p>Add a black counter.</p>
<p>Then the chances, that it contains (<span class="math inline">\(\alpha\)</span>) BBB, (<span class="math inline">\(\beta\)</span>) BWB, (<span class="math inline">\(\gamma\)</span>) WWB, are, as before, <span class="math inline">\(\dfrac{1}{4}\)</span>, <span class="math inline">\(\dfrac{1}{2}\)</span>, <span class="math inline">\(\dfrac{1}{4}\)</span>.</p>
<p>Hence the chance, of now drawing the black one, <span class="math display">\[ = \frac{1}{4}\cdot 1 + \frac{1}{2}\cdot\frac{2}{3} + \frac{1}{4}\cdot\frac{1}{3} = \frac{2}{3}.\]</span></p>
<p>Hence the bag now contains BBW (since any other state of things would not give this chance).</p>
<p>Hence, before the black counter was added, it contained BW, i.e.&nbsp;one black counter and one white.</p>
</blockquote>
<ol type="a">
<li>Show that the probability of drawing a black ball in the described setup is indeed <span class="math inline">\(2/3\)</span>.</li>
<li>Is the logic sound? Why?</li>
</ol>
</div>
<div id="exr-4.5" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.5</strong></span> Of people in a certain city who bought a new vehicle in the past year, <span class="math inline">\(12\%\)</span> of them bought an electric vehicle and <span class="math inline">\(5\%\)</span> of them bought an electric truck. Given that a person bought an electric vehicle, what is the probability that it was a truck?</p>
</div>
<div id="exr-4.6" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.6</strong></span> Mo and Fran each roll a die. The person who rolls the highest number wins; if they roll the same number, they both lose.</p>
<ol type="a">
<li>What is the probability that Fran wins?</li>
<li>If Mo rolls a <span class="math inline">\(3\)</span>, what is the probability that Mo wins?</li>
<li>If Mo rolls a <span class="math inline">\(3\)</span>, what is the probability that Fran wins?</li>
<li>If Mo wins, what is the probability that Fran rolled a <span class="math inline">\(3\)</span>?</li>
<li>If Mo wins, what is the probability that Mo rolled a <span class="math inline">\(3\)</span>?</li>
</ol>
</div>
<div id="exr-4.7" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.7</strong></span> A geneticist is studying two genes. Each gene can be either dominant or recessive. A sample of <span class="math inline">\(100\)</span> individuals has <span class="math inline">\(56\)</span> individuals with both genes dominant, <span class="math inline">\(6\)</span> individuals with both genes recessive, <span class="math inline">\(24\)</span> individuals with only gene one dominant, and the remaining <span class="math inline">\(14\)</span> with only gene two dominant.</p>
<ol type="a">
<li>What is the probability that a randomly sampled individual has dominant gene one?</li>
<li>What is the probability that a randomly sampled individual has dominant gene two?</li>
<li>Given that gene one is dominant, what is the probability that gene two is dominant?</li>
<li>These genes are said to be in linkage equilibrium if the event that gene one is dominant is independent of the event that gene two is dominant. Are these genes in linkage equilibrium?</li>
</ol>
</div>
<div id="exr-4.8" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.8</strong></span> A company manufactures electrical components in lots. Suppose that a particular lot of <span class="math inline">\(10\)</span> has <span class="math inline">\(2\)</span> defective components. Let <span class="math inline">\(A\)</span> be the event that the first component drawn is defective, and let <span class="math inline">\(B\)</span> be the event that the second component drawn is defective.</p>
<ol type="a">
<li>What is <span class="math inline">\(P(A)\)</span>?</li>
<li>What is <span class="math inline">\(P(B|A)\)</span>?</li>
<li>What is <span class="math inline">\(P(A \cap B)\)</span>?</li>
<li>What is <span class="math inline">\(P(A^C \cap B)\)</span>?</li>
<li>What is <span class="math inline">\(P(B)\)</span>?</li>
<li>Are <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> independent?</li>
<li>If the lot had <span class="math inline">\(1000\)</span> components, and <span class="math inline">\(200\)</span> were defective, would it be reasonable to treat <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> as though they are independent? Explain.</li>
</ol>
</div>
<div id="exr-4.9" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.9</strong></span> A certain delivery service offers both express and standard delivery. Seventy-five percent of parcels are sent by standard delivery, and the rest are sent by express. Of those sent standard, <span class="math inline">\(80\%\)</span> arrive the next day, and of those sent express, <span class="math inline">\(95\%\)</span> arrive the next day. A record of a parcel delivery is chosen at random from the company’s files.</p>
<ol type="a">
<li>What is the probability that the parcel was shipped express and arrived the next day?</li>
<li>What is the probability that it arrived the next day?</li>
<li>Given the package arrived the next day, what is the probability that it was sent express?</li>
</ol>
</div>
<div id="exr-4.10" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.10</strong></span> A quality control program at a food production facility involves inspecting finished product for safety. The proportion of items that actually are unsafe is <span class="math inline">\(0.0002\)</span>. If an item is found to be unsafe, the probability is <span class="math inline">\(0.995\)</span> that it will fail the inspection. If an item is safe, the probability is <span class="math inline">\(0.99\)</span> that it will pass the inspection.</p>
<ol type="a">
<li>If an item fails the inspection, what is the probability that it is unsafe?</li>
<li>Which of the following is more correct interpretation to the previous answer:
<ol type="i">
<li>Most items that fail inspection are safe.</li>
<li>Most items that pass inspection are unsafe.</li>
</ol></li>
<li>If an item passes inspection, what is the probability that it is safe?</li>
<li>Which of the following is the more correct interpretation to the previous answer:
<ol type="i">
<li>Most items that fail inspection are unsafe.</li>
<li>Most items that pass inspection are safe.</li>
</ol></li>
<li>Explain why a small probability in part (a) is not a problem, so long as the probability in part (c) is large.</li>
</ol>
</div>
<div id="exr-4.11" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.11</strong></span> A patient goes to see a doctor. The doctor performs a test with <span class="math inline">\(99\)</span> percent reliability–that is, <span class="math inline">\(99\)</span> percent of people who are sick test positive and <span class="math inline">\(99\)</span> percent of the healthy people test negative. The doctor knows that only <span class="math inline">\(1\)</span> in <span class="math inline">\(10000\)</span> people in the country are sick. If the patient tests positive, what are the chances the patient is sick?</p>
</div>
<div id="exr-4.12" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.12</strong></span> Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be events with <span class="math inline">\(P(A) = 0.8\)</span> and <span class="math inline">\(P(A \cap B) = 0.2\)</span>. For what value of <span class="math inline">\(P(B)\)</span> will <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be independent?</p>
</div>
<div id="exr-4.13" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.13</strong></span> Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be events with <span class="math inline">\(P(A) = 0.5\)</span> and <span class="math inline">\(P(A \cap B^C) = 0.4\)</span>. For what value of <span class="math inline">\(P(B)\)</span> will <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be independent?</p>
</div>
<div id="exr-4.14" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.14</strong></span> Prove that if <span class="math inline">\(A\perp B\)</span> then <span class="math inline">\(A\perp B^C\)</span>, <span class="math inline">\(A^C \perp B\)</span> and <span class="math inline">\(A^C \perp B^C\)</span>.</p>
</div>
<div id="exr-4.15" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.15</strong></span> Show that if <span class="math inline">\(A\perp B\)</span> then <span class="math inline">\(P(A|B) = P(A)\)</span> and <span class="math inline">\(P(B|A) = P(B)\)</span>.</p>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Carroll" class="csl-entry" role="listitem">
Carroll, Lewis. 2013. <em>The Mathematical Recreations of Lewis Carroll: Pillow Problems and a Tangled Tale</em>. Mineola, NY: Dover Publications.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Note, this is another result which seems to (on the surface) defy expectations. We will see this again later on in this chapter in a slightly different context. It seems strange that company <span class="math inline">\(A\)</span> is more likely to be late, and yet, we are more likely to see a late package that is sent by company <span class="math inline">\(B\)</span> then a late package that is sent by company <span class="math inline">\(A\)</span>. The reason for this is that company <span class="math inline">\(B\)</span> is used much more frequently than company <span class="math inline">\(A\)</span>, which overcomes the added likelihood of company <span class="math inline">\(A\)</span> being late.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>For instance, <span class="math inline">\(5\)</span> is neither a multiple of <span class="math inline">\(2\)</span> nor of <span class="math inline">\(3\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>For instance, <span class="math inline">\(6\)</span> is a multiple of both <span class="math inline">\(2\)</span> and <span class="math inline">\(3\)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Bayes’ Theorem is named in the same way that the Bayesian interpretation of probability is, and that Bayesian statistics is more broadly. The connections are more than merely surface: Bayes’ Theorem can be viewed as the primary technique with which we can update subjective beliefs about the world. Importantly, however, even those who use a Frequentist view of statistics accept the math of Bayes’ Theorem, and use it frequently.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>In fact, I would go as far as to suggest that learning Bayes’ Theorem by itself is less important than fully grasping the definition of conditional probability alongside the multiplication rule and the law of total probability. I myself do not remember Bayes’ Theorem directly, but can write it down directly from these definitions without any thought.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>It is worth drawing attention to the language that we have started to use at this point in the notes regarding “events”. In this case our sample space would actually be formed using pairs of information. In particular, we might have <span class="math display">\[\mathcal{S} = \{(\text{Pos. Test}, \text{Illness}), (\text{Neg. Test}, \text{Illness}),(\text{Pos. Test}, \text{No Illness}),(\text{Neg. Test}, \text{No Illness})\}.\]</span> Then the event <span class="math inline">\(A\)</span> here is actually <span class="math inline">\(A = \{(\text{Pos. Test}, \text{Illness}),(\text{Pos. Test}, \text{No Illness})\}\)</span> and <span class="math inline">\(B\)</span> is <span class="math inline">\(\{(\text{Pos. Test}, \text{Illness}),(\text{Neg. Test}, \text{Illness})\}\)</span>. It is far more clunky to make explicit these events, and so we move towards using more natural language. Until you feel confident that you can identify the specific outcomes associated with the events of interest, it is worth writing these out in full.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Since <span class="math inline">\(P(A|B^C) = 1 - P(A^C|B^C) = 1 - 0.95 = 0.05\)</span>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>This counter intuitive fact was an intensely frustrating reality for statisticians everywhere during the height of the COVID-19 pandemic, when politicians and the population at large turned away from testing owing to its perceived “ineffectiveness”. The quantity of interest for knowing how good a test is is <span class="math inline">\(P(A|B)\)</span> and <span class="math inline">\(P(A^C|B^C)\)</span>. However, if a disease is sufficiently rare, with <span class="math inline">\(P(B)\)</span> sufficiently small, then no matter how effective the tests are you will likely have <span class="math inline">\(P(B|A)\)</span> to be low. Note that <span class="math inline">\(P(B|A) &gt;&gt; P(B)\)</span> in the example, and this will also be true in general. A single test cannot say with certainty, however, they are an incredibly effective tool at reducing our uncertainty.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Note that this is another example of a counterintuitive result. Here, <span class="math inline">\(A\)</span> is far more likely to be late, but it is more likely that <span class="math inline">\(B\)</span> delivered a late package to us than <span class="math inline">\(A\)</span> because of the <strong>base rates</strong>. That is, <span class="math inline">\(P(B)\)</span> is much higher to begin than <span class="math inline">\(P(A)\)</span>, and so that is hard to overcome. It is worth noting, however, that originally <span class="math inline">\(P(B)\)</span> is <span class="math inline">\(9\)</span> times more likely than <span class="math inline">\(P(A)\)</span>, and after knowing that package is late it is <span class="math inline">\(\dfrac{6}{5} = 1.2\)</span> times more likely. This major reduction in the relative likelihood is owed to how much more likely <span class="math inline">\(A\)</span> is to deliver late packages than <span class="math inline">\(B\)</span>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Mixing up <span class="math inline">\(P(B|A)\)</span> and <span class="math inline">\(P(A|B)\)</span> is often called <em>confusion of the inverse</em>, and it can lead to very faulty conclusions when ignored. In the medical testing example above, it is important to not confuse “the probability that the test returns positive, assuming you have the illness” with “the probability that you have the illness, given that the test returns positive.” This type of faulty logic has long been used to justify discriminatory behaviour in medicine, the law, and so on. A thorough understanding of statistics and probability helps to ensure that these types of errors are not made, and gives you the tools to push-back on the spots where people are making these arguments incorrectly, particularly when the stakes are high or harm is being done.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>When discussing Bayes’ Theorem we introduced two frequently occurring sources of error when reasoning about probabilities, and showed how to remedy them. <em>Confusion of the inverse</em> occurs when you mix up <span class="math inline">\(P(A|B)\)</span> with <span class="math inline">\(P(B|A)\)</span>, and can lead to disastrous consequences. The <em>base rate fallacy</em> occurs when you fail to take into account the rareness of the marginal events and instead only consider the conditionals (such as seeing that delivery company <span class="math inline">\(A\)</span> was more likely to be late than <span class="math inline">\(B\)</span>, without considering that <span class="math inline">\(B\)</span> was more likely to be used than <span class="math inline">\(A\)</span>). These are both examples of the challenges at the heart of probability and statistics: namely, the subjects are fairly unintuitive once moving beyond the basics. As a result, we need to rely on building up our intuitions over time by making use of the formal rules that we are able to derive.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>Though, perhaps the world will freeze over if <em>(insert-your-least-favourite-team-here)</em> wins the <em>(insert-the-name-of-the-championship-for-the-league-you-care-about-here)</em>?<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Namely, we know that all of the others are then impossible.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>Note, the values in this table are <em>roughly</em> inspired by a subset of the <a href="https://web.archive.org/web/20240103124753/https://www.unb.ca/finance/_assets/documents/rpb/factbooktables/2022enrollment/20221215-tablee3-enrolment-ftehc-fac-acad-lvl-2022fa-final.pdf">Fall 2022 University of New Brunswick Enrolment Numbers</a>.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>This provides further emphasis for the utility of urn models. If you imagine an urn that has balls with two or more traits (say like those in <a href="#exm-conditional-probability-urn" class="quarto-xref">Example&nbsp;<span>4.3</span></a>), then randomly selecting a single ball from this population has an analogous probability distribution.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>That is, the number of students who are enrolled in that faculty, in that year of study.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>Faculty.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>Year of study.<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>It is worth reemphasizing what this probability actually means. If we were to randomly sample, with equal probability, individuals from this population then the probability that an individual selected has both the faculty and year specified is given by the joint probability. That is to say, if we did this over and over and over again (with replacement) in the long-term, these probabilities represent proportion of time those combinations would be observed.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>Note here, <span class="math inline">\(A=4\)</span> has been filled in.<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>We have filled in <span class="math inline">\(C = 0\)</span> here.<a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>This uses <span class="math inline">\(A=4\)</span> and <span class="math inline">\(C=0\)</span>.<a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p>Note, we could also apply Bayes’ Theorem to find the result here. We know that <span class="math inline">\(P(\text{Green}|\text{Pyramid}) = 4/13\)</span>, that <span class="math inline">\(P(\text{Green}) = 15/50\)</span> and that <span class="math inline">\(P(\text{Pyramid}) = 13/50\)</span>. Thus, Bayes’ Theorem gives <span class="math display">\[P(\text{Pyramid}|\text{Green}) = \dfrac{(4/13)(13/50)}{15/50} = \dfrac{4}{15},\]</span> exactly as in the direct derivation.<a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/chapter3.html" class="pagination-link" aria-label="The Core Concepts of Probability">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Core Concepts of Probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/chapter5.html" class="pagination-link" aria-label="Summarizing Statistical Experiments with Random Variables">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summarizing Statistical Experiments with Random Variables</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script type="application/javascript" src="../webex.js"></script>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","openEffect":"zoom","loop":false,"closeEffect":"zoom","descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>